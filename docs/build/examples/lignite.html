

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lignite &mdash; GenCoal v1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=0ec76b63"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ClipIRMol Module" href="../api/ClipIRMol.html" />
    <link rel="prev" title="bitumite" href="bitumite.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GenCoal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bitumite.html">bitumite</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">lignite</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Install-the-package-from-pip-(skip-this-step-if-the-package-is-already-installed)">Install the package from pip (skip this step if the package is already installed)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-package">Import package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-CSV-table-of-13C-NMR">Import CSV table of 13C NMR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-CSV-table-of-IR">Import CSV table of IR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-molecule-scale">input molecule scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="#import-lignite.json-as-input">import lignite.json as input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-revised-molecule-model">checking revised molecule model</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/ClipIRMol.html">ClipIRMol Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/CoalGenerator.html">CoalGenerator Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils.html">utils Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/main.html">main Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GenCoal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">lignite</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/lignite.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lignite">
<h1>lignite<a class="headerlink" href="#lignite" title="Permalink to this heading"></a></h1>
<p>lignite - Structural Model Construction with 70-80% Carbon content <a class="reference external" href="https://colab.research.google.com/github/liuhaodong2021/GenCoal/blob/main/docs/source/examples/lignite.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="Install-the-package-from-pip-(skip-this-step-if-the-package-is-already-installed)">
<h2>Install the package from pip (skip this step if the package is already installed)<a class="headerlink" href="#Install-the-package-from-pip-(skip-this-step-if-the-package-is-already-installed)" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ! pip install clipirmol</span>
</pre></div>
</div>
</div>
</section>
<section id="Import-package">
<h2>Import package<a class="headerlink" href="#Import-package" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set absolute path of coal file directory (optional if installed via pip)</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># add customized coal package to sys.path for call modules in coal</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/home/liuhaodong/CoalModel&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="c1"># import python file from coal file directory</span>
<span class="kn">import</span> <span class="nn">coal.utils</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="kn">import</span> <span class="nn">coal.CoalGenerator</span> <span class="k">as</span> <span class="nn">gen</span>
<span class="kn">import</span> <span class="nn">coal.ClipIRMol</span> <span class="k">as</span> <span class="nn">clipirmol</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;/home/liuhaodong/CoalModel&#39;, &#39;/home/liuhaodong/CoalModel/docs/source/examples&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python38.zip&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python3.8&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python3.8/lib-dynload&#39;, &#39;&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python3.8/site-packages&#39;]
/home/liuhaodong/CoalModel/docs/source/examples
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### if you don&#39;t know elemental proportion in daf, run out this code block to turn ad into daf</span>
<span class="n">C_ad</span> <span class="o">=</span> <span class="mf">78.85</span>  <span class="c1"># 碳</span>
<span class="n">N_ad</span> <span class="o">=</span> <span class="mf">1.44</span>   <span class="c1"># 氮</span>
<span class="n">H_ad</span> <span class="o">=</span> <span class="mf">6.05</span>  <span class="c1"># 氢</span>
<span class="n">S_ad</span> <span class="o">=</span> <span class="mf">0.26</span>  <span class="c1"># 硫</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">2.51</span>   <span class="c1"># 水分</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">1.66</span>   <span class="c1"># 灰分</span>

<span class="n">C_daf</span><span class="p">,</span> <span class="n">N_daf</span><span class="p">,</span> <span class="n">H_daf</span><span class="p">,</span> <span class="n">S_daf</span><span class="p">,</span> <span class="n">O_daf</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ad2daf</span><span class="p">(</span><span class="n">C_ad</span><span class="p">,</span> <span class="n">N_ad</span><span class="p">,</span> <span class="n">H_ad</span><span class="p">,</span> <span class="n">S_ad</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C_daf, N_daf, H_daf, S_daf, O_daf = </span><span class="si">{</span><span class="n">C_daf</span><span class="p">,</span><span class="w"> </span><span class="n">N_daf</span><span class="p">,</span><span class="w"> </span><span class="n">H_daf</span><span class="p">,</span><span class="w"> </span><span class="n">S_daf</span><span class="p">,</span><span class="w"> </span><span class="n">O_daf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
O_ad= 9.230000000000004
C_daf, N_daf, H_daf, S_daf, O_daf = (82.28112282166336, 1.5026609621204217, 6.313263070019827, 0.27131378482729834, 9.631639361369096)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ele_ratio</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">C_daf</span><span class="p">,</span>
        <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="n">H_daf</span><span class="p">,</span>
        <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="n">N_daf</span><span class="p">,</span>
        <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="n">S_daf</span><span class="p">,</span>
        <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="n">O_daf</span>
    <span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ele_ratio</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;C&#39;: 82.28112282166336, &#39;H&#39;: 6.313263070019827, &#39;N&#39;: 1.5026609621204217, &#39;S&#39;: 0.27131378482729834, &#39;O&#39;: 9.631639361369096}
</pre></div></div>
</div>
</section>
<section id="Import-CSV-table-of-13C-NMR">
<h2>Import CSV table of 13C NMR<a class="headerlink" href="#Import-CSV-table-of-13C-NMR" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NMR_file_path</span> <span class="o">=</span> <span class="s2">&quot;lignite/NMR霍林河原煤.csv&quot;</span>
<span class="n">C90</span><span class="p">,</span> <span class="n">C180</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">calculate_C90_C180</span><span class="p">(</span><span class="n">NMR_file_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ppm&gt;90 =&quot;</span><span class="p">,</span> <span class="n">C90</span><span class="p">,</span> <span class="s2">&quot;,ppm&gt;180 =&quot;</span><span class="p">,</span> <span class="n">C180</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_8_0.png" src="../_images/examples_lignite_8_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ppm&gt;90 = 0.614 ,ppm&gt;180 = 0.155
</pre></div></div>
</div>
</section>
<section id="Import-CSV-table-of-IR">
<h2>Import CSV table of IR<a class="headerlink" href="#Import-CSV-table-of-IR" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 输入红外文件</span>
<span class="n">IR_file_path</span> <span class="o">=</span> <span class="s1">&#39;lignite/IR霍林河原煤.csv&#39;</span>

<span class="c1"># 获取分子数据</span>
<span class="n">retrieved_molecules</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">retrieve_small_molecules</span><span class="p">(</span><span class="n">IR_file_path</span><span class="p">)</span>
<span class="c1"># 打印红外光谱检索出来的小分子</span>
<span class="c1"># smiles_and_scores = clipirmol.convert_data_to_smiles_scores(retrieved_molecules)</span>
<span class="c1"># clipirmol.display_molecules(smiles_and_scores)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 从retrieved_molecules获取SMILES字符串</span>
<span class="n">selected_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">retrieved_molecules</span><span class="p">]</span>
<span class="n">extended_smiles_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># 使用connect_rings_C4函数扩展这些SMILES字符串</span>
<span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">selected_smiles</span><span class="p">:</span>
    <span class="n">extended_smiles</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">connect_rings_C4</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="n">extended_smiles_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extended_smiles</span><span class="p">)</span>

<span class="c1"># 更新updated_predicted_smiles_and_scores</span>
<span class="n">updated_predicted_smiles_and_scores</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">mol</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">],</span> <span class="n">mol</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">retrieved_molecules</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">updated_predicted_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">extended_smiles</span> <span class="o">=</span> <span class="n">extended_smiles_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">updated_predicted_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">extended_smiles</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

<span class="c1"># clipirmol.display_molecules(updated_predicted_smiles_and_scores[0])</span>

<span class="c1"># 过滤SMILES</span>
<span class="n">new_smiles_and_scores</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">filter_smiles_and_scores</span><span class="p">(</span><span class="n">updated_predicted_smiles_and_scores</span><span class="p">)</span>
<span class="n">new_smiles_and_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_smiles_and_scores</span><span class="p">]</span>

<span class="c1"># 显示过滤后的图像</span>
<span class="n">clipirmol</span><span class="o">.</span><span class="n">display_molecules</span><span class="p">(</span><span class="n">new_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_11_0.png" src="../_images/examples_lignite_11_0.png" />
</div>
</div>
</section>
<section id="input-molecule-scale">
<h2>input molecule scale<a class="headerlink" href="#input-molecule-scale" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 自己加两环的</span>
<span class="n">coal_smiles_list</span> <span class="o">=</span> <span class="n">selected_smiles</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="c1"># 指定 JSON 文件名</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;lignite.json&#39;</span>

<span class="c1"># 读取现有的 JSON 数据</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="n">data</span><span class="p">[</span><span class="s2">&quot;C_atom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="import-lignite.json-as-input">
<h2>import lignite.json as input<a class="headerlink" href="#import-lignite.json-as-input" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 更新 coal_smiles_list 的值</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;coal_smiles_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coal_smiles_list</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ele_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ele_ratio</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;C90&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C90</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;C180&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C180</span>

<span class="c1"># 将更新后的数据写回 JSON 文件</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Update input information successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Update input information successfully!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 读文件</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;lignite.json&#39;</span><span class="p">)</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">CoalGenerator</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">current_smiles_list</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_16_0.png" src="../_images/examples_lignite_16_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model has 1 O atom in carbonyl
Model has 2 O atom in hydroxyl
Target lignite coal model with molecular formula C100H91O9N2S0
Target attribute: {&#39;C_N_ar&#39;: 63, &#39;C_al&#39;: 39, &#39;O_S&#39;: 6, &#39;H&#39;: 91}
All combinations that meet the target C_N_ar: [{0: 0, 6: 7, 7: 3, 10: 0, 11: 0}, {0: 0, 6: 7, 7: 0, 10: 1, 11: 1}, {0: 0, 6: 6, 7: 1, 10: 2, 11: 0}, {0: 0, 6: 5, 7: 0, 10: 0, 11: 3}, {0: 0, 6: 4, 7: 4, 10: 0, 11: 1}, {0: 0, 6: 4, 7: 1, 10: 1, 11: 2}, {0: 0, 6: 3, 7: 5, 10: 1, 11: 0}, {0: 0, 6: 3, 7: 2, 10: 2, 11: 1}, {0: 0, 6: 2, 7: 3, 10: 3, 11: 0}, {0: 0, 6: 2, 7: 1, 10: 0, 11: 4}, {0: 0, 6: 2, 7: 0, 10: 4, 11: 1}, {0: 0, 6: 1, 7: 5, 10: 0, 11: 2}, {0: 0, 6: 1, 7: 2, 10: 1, 11: 3}, {0: 0, 6: 1, 7: 1, 10: 5, 11: 0}, {0: 0, 6: 0, 7: 9, 10: 0, 11: 0}, {0: 0, 6: 0, 7: 6, 10: 1, 11: 1}, {0: 0, 6: 0, 7: 3, 10: 2, 11: 2}, {0: 0, 6: 0, 7: 0, 10: 3, 11: 3}]
Evaluating combination 1/18
Evaluating combination 2/18
Evaluating combination 3/18
Evaluating combination 4/18
Evaluating combination 5/18
Evaluating combination 6/18
Evaluating combination 7/18
Evaluating combination 8/18
Evaluating combination 9/18
Evaluating combination 10/18
Evaluating combination 11/18
Evaluating combination 12/18
Evaluating combination 13/18
Evaluating combination 14/18
Evaluating combination 15/18
Evaluating combination 16/18
Evaluating combination 17/18
Evaluating combination 18/18
The selection with the minimum total H is: {7: {1: 0, 2: 0}, 11: {1: 3, 2: 0}, 6: {1: 0, 0: 0, 2: 0}, 10: {1: 3, 0: 0, 2: 0}, 0: {0: 0}}
After DFS get a Combination:
Candidate molecules respresenting in SMILES: [&#39;O=CCCCc1cccc2ccccc12&#39;, &#39;O=Cc1cc2ccccc2cn1&#39;, &#39;O=Cc1ccnc2ccccc12&#39;, &#39;CCOc1ccc2ccccc2c1&#39;, &#39;CCOc1ccc2ccccc2c1C&#39;, &#39;OCc1cc2ccccc2cn1&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
Total atom counts: {&#39;C&#39;: 99, &#39;H&#39;: 183, &#39;O&#39;: 6, &#39;N&#39;: 3, &#39;S&#39;: 0}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_16_2.png" src="../_images/examples_lignite_16_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
加丙烷前后
[&#39;O=CCCCc1cccc2ccccc12&#39;, &#39;O=Cc1cc2ccccc2cn1&#39;, &#39;O=Cc1ccnc2ccccc12&#39;, &#39;CCOc1ccc2ccccc2c1&#39;, &#39;CCOc1ccc2ccccc2c1C&#39;, &#39;OCc1cc2ccccc2cn1&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
[&#39;O=C1CCCC(Cc2cccc3ccccc23)C1&#39;, &#39;O=C1CCCc2c1ncc1ccccc21&#39;, &#39;O=C1CCCc2cnc3ccccc3c21&#39;, &#39;CCOc1ccc2ccccc2c1&#39;, &#39;CCOc1ccc2ccccc2c1C&#39;, &#39;OCc1cc2ccccc2cn1&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_16_4.png" src="../_images/examples_lignite_16_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before connect: {&#39;C&#39;: 30, &#39;H&#39;: 29, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 32, &#39;H&#39;: 29, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 23, &#39;H&#39;: 23, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 25, &#39;H&#39;: 23, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 25, &#39;H&#39;: 23, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 27, &#39;H&#39;: 23, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Remaining &#39;C&#39; in list2: 15
methane_count:21
SMILES component list: {&#39;C&#39;: 99, &#39;H&#39;: 135, &#39;O&#39;: 6, &#39;N&#39;: 3, &#39;S&#39;: 0}
连接前的检查 {&#39;C&#39;: 99, &#39;H&#39;: 105, &#39;O&#39;: 6, &#39;N&#39;: 3, &#39;S&#39;: 0}
Predicted SMILES is CCOc1cc2ccc3c(c2c2c1Cc1cc4cnc5c(c4cc1C2)CCC(C1CCc2cnc4ccc6c(c4c2C1=O)Cc1cc2c(CC4CC7CCCCC7C(=O)C4C)cccc2cc1C6C)C5=O)CCCC3OC(C)c1cc2ccc3c(c2cn1)Cc1c(c(OCC)c(C)c2cc4c(cc12)CCCC4)C3
Predicted Chemical Fomula of final coal model is C99H95O6N3S0
不饱和碳原子数量: 60
Unsatutated carbon rate of final coal model is 0.6060606060606061
Predicted elemental ratio of coal model is: {&#39;C&#39;: 83.56808501665753, &#39;H&#39;: 6.730485387761988, &#39;O&#39;: 6.747353772192469, &#39;N&#39;: 2.954075823388015, &#39;S&#39;: 0.0}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_16_6.png" src="../_images/examples_lignite_16_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model has 2 O atom in carbonyl
Model has 4 O atom in hydroxyl
Target lignite coal model with molecular formula C200H183O18N3S0
Target attribute: {&#39;C_N_ar&#39;: 126, &#39;C_al&#39;: 77, &#39;O_S&#39;: 12, &#39;H&#39;: 183}
All combinations that meet the target C_N_ar: [{0: 0, 6: 21, 7: 0, 10: 0, 11: 0}, {0: 0, 6: 18, 7: 1, 10: 0, 11: 1}, {0: 0, 6: 17, 7: 2, 10: 1, 11: 0}, {0: 0, 6: 16, 7: 0, 10: 3, 11: 0}, {0: 0, 6: 15, 7: 2, 10: 0, 11: 2}, {0: 0, 6: 14, 7: 6, 10: 0, 11: 0}, {0: 0, 6: 14, 7: 3, 10: 1, 11: 1}, {0: 0, 6: 14, 7: 0, 10: 2, 11: 2}, {0: 0, 6: 13, 7: 4, 10: 2, 11: 0}, {0: 0, 6: 13, 7: 1, 10: 3, 11: 1}, {0: 0, 6: 12, 7: 3, 10: 0, 11: 3}, {0: 0, 6: 12, 7: 2, 10: 4, 11: 0}, {0: 0, 6: 12, 7: 0, 10: 1, 11: 4}, {0: 0, 6: 11, 7: 7, 10: 0, 11: 1}, {0: 0, 6: 11, 7: 4, 10: 1, 11: 2}, {0: 0, 6: 11, 7: 1, 10: 2, 11: 3}, {0: 0, 6: 11, 7: 0, 10: 6, 11: 0}, {0: 0, 6: 10, 7: 8, 10: 1, 11: 0}, {0: 0, 6: 10, 7: 5, 10: 2, 11: 1}, {0: 0, 6: 10, 7: 2, 10: 3, 11: 2}, {0: 0, 6: 10, 7: 0, 10: 0, 11: 6}, {0: 0, 6: 9, 7: 6, 10: 3, 11: 0}, {0: 0, 6: 9, 7: 4, 10: 0, 11: 4}, {0: 0, 6: 9, 7: 3, 10: 4, 11: 1}, {0: 0, 6: 9, 7: 1, 10: 1, 11: 5}, {0: 0, 6: 9, 7: 0, 10: 5, 11: 2}, {0: 0, 6: 8, 7: 8, 10: 0, 11: 2}, {0: 0, 6: 8, 7: 5, 10: 1, 11: 3}, {0: 0, 6: 8, 7: 4, 10: 5, 11: 0}, {0: 0, 6: 8, 7: 2, 10: 2, 11: 4}, {0: 0, 6: 8, 7: 1, 10: 6, 11: 1}, {0: 0, 6: 7, 7: 12, 10: 0, 11: 0}, {0: 0, 6: 7, 7: 9, 10: 1, 11: 1}, {0: 0, 6: 7, 7: 6, 10: 2, 11: 2}, {0: 0, 6: 7, 7: 3, 10: 3, 11: 3}, {0: 0, 6: 7, 7: 2, 10: 7, 11: 0}, {0: 0, 6: 7, 7: 1, 10: 0, 11: 7}, {0: 0, 6: 7, 7: 0, 10: 4, 11: 4}, {0: 0, 6: 6, 7: 10, 10: 2, 11: 0}, {0: 0, 6: 6, 7: 7, 10: 3, 11: 1}, {0: 0, 6: 6, 7: 5, 10: 0, 11: 5}, {0: 0, 6: 6, 7: 4, 10: 4, 11: 2}, {0: 0, 6: 6, 7: 2, 10: 1, 11: 6}, {0: 0, 6: 6, 7: 1, 10: 5, 11: 3}, {0: 0, 6: 6, 7: 0, 10: 9, 11: 0}, {0: 0, 6: 5, 7: 9, 10: 0, 11: 3}, {0: 0, 6: 5, 7: 8, 10: 4, 11: 0}, {0: 0, 6: 5, 7: 6, 10: 1, 11: 4}, {0: 0, 6: 5, 7: 5, 10: 5, 11: 1}, {0: 0, 6: 5, 7: 3, 10: 2, 11: 5}, {0: 0, 6: 5, 7: 2, 10: 6, 11: 2}, {0: 0, 6: 5, 7: 0, 10: 3, 11: 6}, {0: 0, 6: 4, 7: 13, 10: 0, 11: 1}, {0: 0, 6: 4, 7: 10, 10: 1, 11: 2}, {0: 0, 6: 4, 7: 7, 10: 2, 11: 3}, {0: 0, 6: 4, 7: 6, 10: 6, 11: 0}, {0: 0, 6: 4, 7: 4, 10: 3, 11: 4}, {0: 0, 6: 4, 7: 3, 10: 7, 11: 1}, {0: 0, 6: 4, 7: 2, 10: 0, 11: 8}, {0: 0, 6: 4, 7: 1, 10: 4, 11: 5}, {0: 0, 6: 4, 7: 0, 10: 8, 11: 2}, {0: 0, 6: 3, 7: 14, 10: 1, 11: 0}, {0: 0, 6: 3, 7: 11, 10: 2, 11: 1}, {0: 0, 6: 3, 7: 8, 10: 3, 11: 2}, {0: 0, 6: 3, 7: 6, 10: 0, 11: 6}, {0: 0, 6: 3, 7: 5, 10: 4, 11: 3}, {0: 0, 6: 3, 7: 4, 10: 8, 11: 0}, {0: 0, 6: 3, 7: 3, 10: 1, 11: 7}, {0: 0, 6: 3, 7: 2, 10: 5, 11: 4}, {0: 0, 6: 3, 7: 1, 10: 9, 11: 1}, {0: 0, 6: 3, 7: 0, 10: 2, 11: 8}, {0: 0, 6: 2, 7: 12, 10: 3, 11: 0}, {0: 0, 6: 2, 7: 10, 10: 0, 11: 4}, {0: 0, 6: 2, 7: 9, 10: 4, 11: 1}, {0: 0, 6: 2, 7: 7, 10: 1, 11: 5}, {0: 0, 6: 2, 7: 6, 10: 5, 11: 2}, {0: 0, 6: 2, 7: 4, 10: 2, 11: 6}, {0: 0, 6: 2, 7: 3, 10: 6, 11: 3}, {0: 0, 6: 2, 7: 2, 10: 10, 11: 0}, {0: 0, 6: 2, 7: 1, 10: 3, 11: 7}, {0: 0, 6: 2, 7: 0, 10: 7, 11: 4}, {0: 0, 6: 1, 7: 14, 10: 0, 11: 2}, {0: 0, 6: 1, 7: 11, 10: 1, 11: 3}, {0: 0, 6: 1, 7: 10, 10: 5, 11: 0}, {0: 0, 6: 1, 7: 8, 10: 2, 11: 4}, {0: 0, 6: 1, 7: 7, 10: 6, 11: 1}, {0: 0, 6: 1, 7: 5, 10: 3, 11: 5}, {0: 0, 6: 1, 7: 4, 10: 7, 11: 2}, {0: 0, 6: 1, 7: 3, 10: 0, 11: 9}, {0: 0, 6: 1, 7: 2, 10: 4, 11: 6}, {0: 0, 6: 1, 7: 1, 10: 8, 11: 3}, {0: 0, 6: 1, 7: 0, 10: 12, 11: 0}, {0: 0, 6: 1, 7: 0, 10: 1, 11: 10}, {0: 0, 6: 0, 7: 18, 10: 0, 11: 0}, {0: 0, 6: 0, 7: 15, 10: 1, 11: 1}, {0: 0, 6: 0, 7: 12, 10: 2, 11: 2}, {0: 0, 6: 0, 7: 9, 10: 3, 11: 3}, {0: 0, 6: 0, 7: 8, 10: 7, 11: 0}, {0: 0, 6: 0, 7: 7, 10: 0, 11: 7}, {0: 0, 6: 0, 7: 6, 10: 4, 11: 4}, {0: 0, 6: 0, 7: 5, 10: 8, 11: 1}, {0: 0, 6: 0, 7: 4, 10: 1, 11: 8}, {0: 0, 6: 0, 7: 3, 10: 5, 11: 5}, {0: 0, 6: 0, 7: 2, 10: 9, 11: 2}, {0: 0, 6: 0, 7: 1, 10: 2, 11: 9}, {0: 0, 6: 0, 7: 0, 10: 6, 11: 6}]
Evaluating combination 1/106
Evaluating combination 2/106
Evaluating combination 3/106
Evaluating combination 4/106
Evaluating combination 5/106
Evaluating combination 6/106
Evaluating combination 7/106
Evaluating combination 8/106
Evaluating combination 9/106
Evaluating combination 10/106
Evaluating combination 11/106
Evaluating combination 12/106
Evaluating combination 13/106
Evaluating combination 14/106
Evaluating combination 15/106
Evaluating combination 16/106
Evaluating combination 17/106
Evaluating combination 18/106
Evaluating combination 19/106
Evaluating combination 20/106
Evaluating combination 21/106
Evaluating combination 22/106
Evaluating combination 23/106
Evaluating combination 24/106
Evaluating combination 25/106
Evaluating combination 26/106
Evaluating combination 27/106
Evaluating combination 28/106
Evaluating combination 29/106
Evaluating combination 30/106
Evaluating combination 31/106
Evaluating combination 32/106
Evaluating combination 33/106
Evaluating combination 34/106
Evaluating combination 35/106
Evaluating combination 36/106
Evaluating combination 37/106
Evaluating combination 38/106
Evaluating combination 39/106
Evaluating combination 40/106
Evaluating combination 41/106
Evaluating combination 42/106
Evaluating combination 43/106
Evaluating combination 44/106
Evaluating combination 45/106
Evaluating combination 46/106
Evaluating combination 47/106
Evaluating combination 48/106
Evaluating combination 49/106
Evaluating combination 50/106
Evaluating combination 51/106
Evaluating combination 52/106
Evaluating combination 53/106
Evaluating combination 54/106
Evaluating combination 55/106
Evaluating combination 56/106
Evaluating combination 57/106
Evaluating combination 58/106
Evaluating combination 59/106
Evaluating combination 60/106
Evaluating combination 61/106
Evaluating combination 62/106
Evaluating combination 63/106
Evaluating combination 64/106
Evaluating combination 65/106
Evaluating combination 66/106
Evaluating combination 67/106
Evaluating combination 68/106
Evaluating combination 69/106
Evaluating combination 70/106
Evaluating combination 71/106
Evaluating combination 72/106
Evaluating combination 73/106
Evaluating combination 74/106
Evaluating combination 75/106
Evaluating combination 76/106
Evaluating combination 77/106
Evaluating combination 78/106
Evaluating combination 79/106
Evaluating combination 80/106
Evaluating combination 81/106
Evaluating combination 82/106
Evaluating combination 83/106
Evaluating combination 84/106
Evaluating combination 85/106
Evaluating combination 86/106
Evaluating combination 87/106
Evaluating combination 88/106
Evaluating combination 89/106
Evaluating combination 90/106
Evaluating combination 91/106
Evaluating combination 92/106
Evaluating combination 93/106
Evaluating combination 94/106
Evaluating combination 95/106
Evaluating combination 96/106
Evaluating combination 97/106
Evaluating combination 98/106
Evaluating combination 99/106
Evaluating combination 100/106
Evaluating combination 101/106
Evaluating combination 102/106
Evaluating combination 103/106
Evaluating combination 104/106
Evaluating combination 105/106
Evaluating combination 106/106
The selection with the minimum total H is: {7: {1: 0, 2: 0}, 11: {1: 10, 2: 0}, 6: {1: 1, 0: 0, 2: 0}, 10: {1: 1, 0: 0, 2: 0}, 0: {0: 0}}
After DFS get a Combination:
Candidate molecules respresenting in SMILES: [&#39;O=CCCCc1cccc2ccccc12&#39;, &#39;O=Cc1cncc2ccccc12&#39;, &#39;O=CCCCc1cccc2ccccc12&#39;, &#39;O=Cc1cncc2ccccc12&#39;, &#39;O=CCCc1cccc2ccccc12&#39;, &#39;O=CCCc1cccc2ccccc12&#39;, &#39;O=Cc1cc2ccccc2cn1&#39;, &#39;O=Cc1cc2ccccc2cn1&#39;, &#39;O=Cc1ccc2ccccc2c1&#39;, &#39;O=Cc1ccc2ccccc2c1&#39;, &#39;OCc1cccnc1&#39;, &#39;Oc1cccc2ccccc12&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
Total atom counts: {&#39;C&#39;: 198, &#39;H&#39;: 375, &#39;O&#39;: 12, &#39;N&#39;: 5, &#39;S&#39;: 0}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_16_8.png" src="../_images/examples_lignite_16_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
加丙烷前后
[&#39;O=CCCCc1cccc2ccccc12&#39;, &#39;O=Cc1cncc2ccccc12&#39;, &#39;O=CCCCc1cccc2ccccc12&#39;, &#39;O=Cc1cncc2ccccc12&#39;, &#39;O=CCCc1cccc2ccccc12&#39;, &#39;O=CCCc1cccc2ccccc12&#39;, &#39;O=Cc1cc2ccccc2cn1&#39;, &#39;O=Cc1cc2ccccc2cn1&#39;, &#39;O=Cc1ccc2ccccc2c1&#39;, &#39;O=Cc1ccc2ccccc2c1&#39;, &#39;OCc1cccnc1&#39;, &#39;Oc1cccc2ccccc12&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
[&#39;O=C1CCCC(Cc2cccc3ccccc23)C1&#39;, &#39;O=C1CCCc2ncc3ccccc3c21&#39;, &#39;O=C1CCCC(Cc2cccc3ccccc23)C1&#39;, &#39;O=C1CCCc2ncc3ccccc3c21&#39;, &#39;O=C1CCCC(c2cccc3ccccc23)C1&#39;, &#39;O=C1CCCC(c2cccc3ccccc23)C1&#39;, &#39;O=C1CCCc2c1ncc1ccccc21&#39;, &#39;O=C1CCCc2c1ncc1ccccc21&#39;, &#39;O=C1CCCc2cc3ccccc3cc21&#39;, &#39;O=C1CCCc2cc3ccccc3cc21&#39;, &#39;OCc1cccnc1&#39;, &#39;Oc1cccc2ccccc12&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_16_10.png" src="../_images/examples_lignite_16_10.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before connect: {&#39;C&#39;: 24, &#39;H&#39;: 20, &#39;O&#39;: 2, &#39;N&#39;: 0, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 26, &#39;H&#39;: 20, &#39;O&#39;: 2, &#39;N&#39;: 0, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 30, &#39;H&#39;: 28, &#39;O&#39;: 2, &#39;N&#39;: 0, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 32, &#39;H&#39;: 28, &#39;O&#39;: 2, &#39;N&#39;: 0, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 30, &#39;H&#39;: 29, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 32, &#39;H&#39;: 29, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 26, &#39;H&#39;: 22, &#39;O&#39;: 2, &#39;N&#39;: 2, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 28, &#39;H&#39;: 22, &#39;O&#39;: 2, &#39;N&#39;: 2, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 29, &#39;H&#39;: 27, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 31, &#39;H&#39;: 27, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 23, &#39;H&#39;: 25, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 25, &#39;H&#39;: 25, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Remaining &#39;C&#39; in list2: 24
methane_count:36
SMILES component list: {&#39;C&#39;: 198, &#39;H&#39;: 247, &#39;O&#39;: 12, &#39;N&#39;: 5, &#39;S&#39;: 0}
连接前的检查 {&#39;C&#39;: 198, &#39;H&#39;: 207, &#39;O&#39;: 12, &#39;N&#39;: 5, &#39;S&#39;: 0}
Predicted SMILES is CC1CCc2ncc3c4c(c5c(c3c2C1=O)CCCC5)Cc1ccc2c(CC3CCC(C)C(=O)C3C3C(=O)C(C5C(=O)c6c(ncc7cc8c(cc67)Cc6ccc7c9c(ncc7c6C8)C(=O)C(C6CCc7c(ncc8ccc%10c(c78)Cc7c(cc(C8CCC(Oc%11cccc%12cc%13c(cc%11%12)Cc%11cc%12cc%14c(cc%12cc%11C%13C)CC%11CCCCC%11C%14=O)C(=O)C8C)c8ccccc78)C%10)C6=O)CC9)C6CCCCC65)CCC3c3c5c(cc6ccccc36)C(OCc3cnc6c(c3)Cc3cc(C(C)C7CCC(C)C(=O)C7C)c7ccccc7c3C6)c3ccc6cc7c(cc6c3C5)C3CCCCC3C(C)C7=O)cccc2c1C4
Predicted Chemical Fomula of final coal model is C198H181O12N5S0
不饱和碳原子数量: 121
Unsatutated carbon rate of final coal model is 0.6111111111111112
Predicted elemental ratio of coal model is: {&#39;C&#39;: 84.2514981516242, &#39;H&#39;: 6.464107071870888, &#39;O&#39;: 6.802533093260603, &#39;N&#39;: 2.481861683244298, &#39;S&#39;: 0.0}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">current_smiles_list</span><span class="p">:</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">drawMolecule</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_17_0.png" src="../_images/examples_lignite_17_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_lignite_17_1.png" src="../_images/examples_lignite_17_1.png" />
</div>
</div>
</section>
<section id="checking-revised-molecule-model">
<h2>checking revised molecule model<a class="headerlink" href="#checking-revised-molecule-model" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratio</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">calculate_unsaturated_carbon_ratio</span><span class="p">(</span><span class="s2">&quot;CC1CCc(c(C1=O)cc2)c3c2c4c(Cc(cc5)c(C4)c6c5c7c(C(CC(C7=O)C8CCc(cn9)c(C8=O)c</span><span class="si">%10c</span><span class="s2">9c</span><span class="si">%11c</span><span class="s2">(C(c(c%12)c(C%11)cc</span><span class="si">%13c%12c%14c</span><span class="s2">(CCC(C%14=O)C%15CCC(C(C%15=O)C)c(cc%16)cc</span><span class="si">%17c%16c%18c</span><span class="s2">(Cc(c(C%18)c(COC%19CCc(cc%20)c(C%19=O)c</span><span class="si">%21c%20c</span><span class="s2">c</span><span class="si">%22c</span><span class="s2">(Cc(c(C%22)cc%23)c</span><span class="si">%24c%23c</span><span class="s2">ccc%24C(C%25CCC(C(C%25C%26CCc(c(C%26=O)c</span><span class="si">%27c</span><span class="s2">%28Cc(c%29)c(C%27)cc</span><span class="si">%30c%29c</span><span class="s2">(CC%31CCC(C(C%31C)=O)C)cc</span><span class="si">%32c</span><span class="s2">%30CCCC%32)c</span><span class="si">%33c%28c</span><span class="s2">ccc%33)=O)OCC%34CCCCC</span><span class="si">%34c%35c</span><span class="s2">(Cc(c(C%36)cc%37)c</span><span class="si">%38c%37c</span><span class="s2">cc(C%39CCC(C(C%39C)=O)C)c%38)c%36ncc%35)C)c%21)n%40)c</span><span class="si">%41c%40c%42c</span><span class="s2">(CCCC%42)cc%41)cc%17)cn%13)C)cc%10)C)nc6)cc3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsatutated carbon rate of final coal model is&quot;</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
不饱和碳原子数量: 121
Unsatutated carbon rate of final coal model is 0.6111111111111112
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bitumite.html" class="btn btn-neutral float-left" title="bitumite" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api/ClipIRMol.html" class="btn btn-neutral float-right" title="ClipIRMol Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Haodong Liu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>