

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bitumite &mdash; GenCoal v1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=0ec76b63"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="lignite" href="lignite.html" />
    <link rel="prev" title="Welcome to GenCoal’s documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GenCoal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">bitumite</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Install-the-package-from-pip-(skip-this-step-if-the-package-is-already-installed)">Install the package from pip (skip this step if the package is already installed)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-package">Import package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ad-to-daf-in-elemental-proportion">ad to daf in elemental proportion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-elemental-proportion">Import elemental proportion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-CSV-table-of-13C-NMR">Import CSV table of 13C NMR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-CSV-table-of-IR">Import CSV table of IR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-molecule-scale">input molecule scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="#import-bitumite.json-as-input">import bitumite.json as input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-revised-molecule-model">checking revised molecule model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lignite.html">lignite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/ClipIRMol.html">ClipIRMol Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/CoalGenerator.html">CoalGenerator Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils.html">utils Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/main.html">main Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GenCoal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">bitumite</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/bitumite.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bitumite">
<h1>bitumite<a class="headerlink" href="#bitumite" title="Permalink to this heading"></a></h1>
<p>Bitumite - Structural Model Construction with 80-95% Carbon content <a class="reference external" href="https://colab.research.google.com/github/liuhaodong2021/GenCoal/blob/main/docs/source/examples/bitumite.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="Install-the-package-from-pip-(skip-this-step-if-the-package-is-already-installed)">
<h2>Install the package from pip (skip this step if the package is already installed)<a class="headerlink" href="#Install-the-package-from-pip-(skip-this-step-if-the-package-is-already-installed)" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ! pip install clipirmol</span>
</pre></div>
</div>
</div>
</section>
<section id="Import-package">
<h2>Import package<a class="headerlink" href="#Import-package" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set absolute path of coal file directory (optional if installed via pip)</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># add customized coal package to sys.path for call modules in coal</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/home/liuhaodong/CoalModel&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="c1"># import python file from coal file directory</span>
<span class="kn">import</span> <span class="nn">coal.utils</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="kn">import</span> <span class="nn">coal.CoalGenerator</span> <span class="k">as</span> <span class="nn">gen</span>
<span class="kn">import</span> <span class="nn">coal.ClipIRMol</span> <span class="k">as</span> <span class="nn">clipirmol</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;/home/liuhaodong/CoalModel&#39;, &#39;/home/liuhaodong/CoalModel/docs/source/examples&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python38.zip&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python3.8&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python3.8/lib-dynload&#39;, &#39;&#39;, &#39;/home/liuhaodong/.conda/envs/clipirmol/lib/python3.8/site-packages&#39;]
/home/liuhaodong/CoalModel/docs/source/examples
</pre></div></div>
</div>
</section>
<section id="ad-to-daf-in-elemental-proportion">
<h2>ad to daf in elemental proportion<a class="headerlink" href="#ad-to-daf-in-elemental-proportion" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_ad</span> <span class="o">=</span> <span class="mf">79.37</span>  <span class="c1"># 碳</span>
<span class="n">N_ad</span> <span class="o">=</span> <span class="mf">1.20</span>   <span class="c1"># 氮</span>
<span class="n">H_ad</span> <span class="o">=</span> <span class="mf">4.11</span>  <span class="c1"># 氢</span>
<span class="n">S_ad</span> <span class="o">=</span> <span class="mf">0.45</span>  <span class="c1"># 硫</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">0.83</span>   <span class="c1"># 水分</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">10.75</span>   <span class="c1"># 灰分</span>

<span class="n">C_daf</span><span class="p">,</span> <span class="n">N_daf</span><span class="p">,</span> <span class="n">H_daf</span><span class="p">,</span> <span class="n">S_daf</span><span class="p">,</span> <span class="n">O_daf</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ad2daf</span><span class="p">(</span><span class="n">C_ad</span><span class="p">,</span> <span class="n">N_ad</span><span class="p">,</span> <span class="n">H_ad</span><span class="p">,</span> <span class="n">S_ad</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C_daf, N_daf, H_daf, S_daf, O_daf = </span><span class="si">{</span><span class="n">C_daf</span><span class="p">,</span><span class="w"> </span><span class="n">N_daf</span><span class="p">,</span><span class="w"> </span><span class="n">H_daf</span><span class="p">,</span><span class="w"> </span><span class="n">S_daf</span><span class="p">,</span><span class="w"> </span><span class="n">O_daf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
O_ad= 3.289999999999992
C_daf, N_daf, H_daf, S_daf, O_daf = (89.76475910427504, 1.3571590137977831, 4.648269622257408, 0.5089346301741687, 3.7208776294955803)
</pre></div></div>
</div>
</section>
<section id="Import-elemental-proportion">
<h2>Import elemental proportion<a class="headerlink" href="#Import-elemental-proportion" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># daf       C       H       N       S       O</span>
<span class="c1"># 主2        89.76   4.74    1.45    1.78    2.27</span>
<span class="c1"># 主3        88.51   5.03    1.54    1.09    3.83</span>
<span class="c1"># 肥2        88.48   5.20    1.57    0.45    4.30</span>
<span class="c1"># 肥3        87.22   5.03    1.51    2.08    4.16</span>
<span class="c1"># 瘦2        90.34   4.45    1.55    1.00    2.66</span>
<span class="c1"># 瘦4        91.59   4.41    1.62    0.43    1.95</span>
<span class="c1"># FS</span>
<span class="n">ele_ratio</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">C_daf</span><span class="p">,</span>
        <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="n">H_daf</span><span class="p">,</span>
        <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="n">N_daf</span><span class="p">,</span>
        <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="n">S_daf</span><span class="p">,</span>
        <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="n">O_daf</span>
    <span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ele_ratio</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;C&#39;: 89.76475910427504, &#39;H&#39;: 4.648269622257408, &#39;N&#39;: 1.3571590137977831, &#39;S&#39;: 0.5089346301741687, &#39;O&#39;: 3.7208776294955803}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="Import-CSV-table-of-13C-NMR">
<h2>Import CSV table of 13C NMR<a class="headerlink" href="#Import-CSV-table-of-13C-NMR" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NMR_file_path</span> <span class="o">=</span> <span class="s2">&quot;bitumite/TL-核磁.csv&quot;</span>
<span class="n">C90</span><span class="p">,</span> <span class="n">C180</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">calculate_C90_C180</span><span class="p">(</span><span class="n">NMR_file_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ppm&gt;90 =&quot;</span><span class="p">,</span> <span class="n">C90</span><span class="p">,</span> <span class="s2">&quot;,ppm&gt;180 =&quot;</span><span class="p">,</span> <span class="n">C180</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_11_0.png" src="../_images/examples_bitumite_11_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ppm&gt;90 = 0.739 ,ppm&gt;180 = 0.062
</pre></div></div>
</div>
</section>
<section id="Import-CSV-table-of-IR">
<h2>Import CSV table of IR<a class="headerlink" href="#Import-CSV-table-of-IR" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 输入红外文件</span>
<span class="n">IR_file_path</span> <span class="o">=</span> <span class="s1">&#39;bitumite/TL-IR.CSV&#39;</span>

<span class="c1"># 获取分子数据</span>
<span class="n">retrieved_molecules</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">retrieve_small_molecules</span><span class="p">(</span><span class="n">IR_file_path</span><span class="p">)</span>

<span class="c1"># 打印红外光谱检索出来的小分子</span>
<span class="c1"># smiles_and_scores = clipirmol.convert_data_to_smiles_scores(retrieved_molecules)</span>
<span class="c1"># clipirmol.display_molecules(smiles_and_scores)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 从retrieved_molecules获取SMILES字符串</span>
<span class="n">selected_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">retrieved_molecules</span><span class="p">]</span>
<span class="n">extended_smiles_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># 使用connect_rings_C4函数扩展这些SMILES字符串</span>
<span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">selected_smiles</span><span class="p">:</span>
    <span class="n">extended_smiles</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">connect_rings_C4</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="n">extended_smiles</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">connect_rings_C4</span><span class="p">(</span><span class="n">extended_smiles</span><span class="p">)</span>  <span class="c1"># 再次扩展</span>
    <span class="n">extended_smiles_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extended_smiles</span><span class="p">)</span>

<span class="c1"># 更新updated_predicted_smiles_and_scores</span>
<span class="n">updated_predicted_smiles_and_scores</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">mol</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">],</span> <span class="n">mol</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">retrieved_molecules</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">updated_predicted_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">extended_smiles</span> <span class="o">=</span> <span class="n">extended_smiles_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">updated_predicted_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">extended_smiles</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

<span class="c1"># clipirmol.display_molecules(updated_predicted_smiles_and_scores[0])</span>

<span class="c1"># 过滤SMILES</span>
<span class="n">new_smiles_and_scores</span> <span class="o">=</span> <span class="n">clipirmol</span><span class="o">.</span><span class="n">filter_smiles_and_scores</span><span class="p">(</span><span class="n">updated_predicted_smiles_and_scores</span><span class="p">)</span>
<span class="n">new_smiles_and_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_smiles_and_scores</span><span class="p">]</span>

<span class="c1"># 显示过滤后的图像</span>
<span class="n">clipirmol</span><span class="o">.</span><span class="n">display_molecules</span><span class="p">(</span><span class="n">new_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_14_0.png" src="../_images/examples_bitumite_14_0.png" />
</div>
</div>
</section>
<section id="input-molecule-scale">
<h2>input molecule scale<a class="headerlink" href="#input-molecule-scale" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coal_smiles_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_smiles_and_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="c1"># 指定 JSON 文件名</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;bitumite.json&#39;</span>

<span class="c1"># 读取现有的 JSON 数据</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="n">data</span><span class="p">[</span><span class="s2">&quot;C_atom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="import-bitumite.json-as-input">
<h2>import bitumite.json as input<a class="headerlink" href="#import-bitumite.json-as-input" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 更新 coal_smiles_list 的值</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;coal_smiles_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coal_smiles_list</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ele_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ele_ratio</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;C90&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C90</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;C180&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C180</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bitumite&quot;</span>

<span class="c1"># 将更新后的数据写回 JSON 文件</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Update input information successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Update input information successfully!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 读文件</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;bitumite.json&#39;</span><span class="p">)</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">CoalGenerator</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">current_smiles_list</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_19_0.png" src="../_images/examples_bitumite_19_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model has 0 O atom in carbonyl
Model has 0 O atom in hydroxyl
Target bitumite coal model with molecular formula C100H62O3N1S0
Target attribute: {&#39;C_N_ar&#39;: 75, &#39;C_al&#39;: 26, &#39;O_S&#39;: 3, &#39;H&#39;: 62}
All combinations that meet the target C_N_ar: [{0: 0, 14: 3, 15: 1, 16: 0, 18: 1}, {0: 0, 14: 2, 15: 1, 16: 2, 18: 0}, {0: 0, 14: 1, 15: 3, 16: 1, 18: 0}, {0: 0, 14: 0, 15: 5, 16: 0, 18: 0}]
Evaluating combination 1/4
Evaluating combination 2/4
Evaluating combination 3/4
Evaluating combination 4/4
The selection with the minimum total H is: {15: {1: 3, 2: 0}, 14: {1: 0, 0: 1, 2: 0}, 16: {0: 1}, 18: {0: 0}, 0: {0: 0}}
After DFS get a Combination:
Candidate molecules respresenting in SMILES: [&#39;O=Cc1ccnc2cc3ccccc3cc12&#39;, &#39;O=CCCc1c2ccccc2cc2ccccc12&#39;, &#39;O=CCCCc1c2ccccc2cc2ccccc12&#39;, &#39;c1ccc2c(c1)ccc3ccccc23&#39;, &#39;C1(C(C=CC=C2)=C2C3=C4CC=C3)=C4C=CC=C1&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
Total atom counts: {&#39;C&#39;: 100, &#39;H&#39;: 0, &#39;O&#39;: 3, &#39;N&#39;: 1, &#39;S&#39;: 0}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_19_2.png" src="../_images/examples_bitumite_19_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
加丙烷前后
[&#39;O=Cc1ccnc2cc3ccccc3cc12&#39;, &#39;O=CCCc1c2ccccc2cc2ccccc12&#39;, &#39;O=CCCCc1c2ccccc2cc2ccccc12&#39;, &#39;c1ccc2c(c1)ccc3ccccc23&#39;, &#39;C1(C(C=CC=C2)=C2C3=C4CC=C3)=C4C=CC=C1&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
[&#39;O=C1CCCc2cnc3cc4ccccc4cc3c21&#39;, &#39;O=C1CCCC(c2c3ccccc3cc3ccccc23)C1&#39;, &#39;O=C1CCCC(Cc2c3ccccc3cc3ccccc23)C1&#39;, &#39;c1ccc2c(c1)ccc3ccccc23&#39;, &#39;C1(C(C=CC=C2)=C2C3=C4CC=C3)=C4C=CC=C1&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_19_4.png" src="../_images/examples_bitumite_19_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before connect: {&#39;C&#39;: 38, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 0, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 40, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 0, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 37, &#39;H&#39;: 0, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 39, &#39;H&#39;: 0, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 14, &#39;H&#39;: 0, &#39;O&#39;: 0, &#39;N&#39;: 0, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 14, &#39;H&#39;: 0, &#39;O&#39;: 0, &#39;N&#39;: 0, &#39;S&#39;: 0}
Remaining &#39;C&#39; in list2: 7
methane_count:11
SMILES component list: {&#39;C&#39;: 100, &#39;H&#39;: 0, &#39;O&#39;: 3, &#39;N&#39;: 1, &#39;S&#39;: 0}
连接前的检查 {&#39;C&#39;: 100, &#39;H&#39;: 0, &#39;O&#39;: 3, &#39;N&#39;: 1, &#39;S&#39;: 0}
Predicted SMILES is CC1CCc2cnc3cc4c5c(ccc4cc3c2C1=O)Cc1cc2c(C3CCC(C4c6cc7c(cc6C(C)c6c4ccc4c(CC8CC9CCCCC9C(=O)C8C)c8ccccc8cc64)c4c(c6ccccc67)CC=C4)C(=O)C3c3ccc4c(ccc6ccccc64)c3)c3ccccc3cc2cc1C5
Predicted Chemical Fomula of final coal model is C100H0O3N1S0
不饱和碳原子数量: 74
Unsatutated carbon rate of final coal model is 0.74
Predicted elemental ratio of coal model is: {&#39;C&#39;: 95.09030015597659, &#39;H&#39;: 0.0, &#39;O&#39;: 3.800444968765093, &#39;N&#39;: 1.1092548752583116, &#39;S&#39;: 0.0}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_19_6.png" src="../_images/examples_bitumite_19_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model has 0 O atom in carbonyl
Model has 0 O atom in hydroxyl
Target bitumite coal model with molecular formula C200H124O6N3S0
Target attribute: {&#39;C_N_ar&#39;: 151, &#39;C_al&#39;: 52, &#39;O_S&#39;: 6, &#39;H&#39;: 124}
All combinations that meet the target C_N_ar: [{0: 0, 14: 6, 15: 1, 16: 1, 18: 2}, {0: 0, 14: 5, 15: 3, 16: 0, 18: 2}, {0: 0, 14: 5, 15: 1, 16: 3, 18: 1}, {0: 0, 14: 4, 15: 3, 16: 2, 18: 1}, {0: 0, 14: 4, 15: 1, 16: 5, 18: 0}, {0: 0, 14: 3, 15: 5, 16: 1, 18: 1}, {0: 0, 14: 3, 15: 3, 16: 4, 18: 0}, {0: 0, 14: 2, 15: 7, 16: 0, 18: 1}, {0: 0, 14: 2, 15: 5, 16: 3, 18: 0}, {0: 0, 14: 2, 15: 1, 16: 0, 18: 6}, {0: 0, 14: 1, 15: 7, 16: 2, 18: 0}, {0: 0, 14: 1, 15: 1, 16: 2, 18: 5}, {0: 0, 14: 0, 15: 9, 16: 1, 18: 0}, {0: 0, 14: 0, 15: 3, 16: 1, 18: 5}, {0: 0, 14: 0, 15: 1, 16: 4, 18: 4}]
Evaluating combination 1/15
Evaluating combination 2/15
Evaluating combination 3/15
Evaluating combination 4/15
Evaluating combination 5/15
Evaluating combination 6/15
Evaluating combination 7/15
Evaluating combination 8/15
Evaluating combination 9/15
Evaluating combination 10/15
Evaluating combination 11/15
Evaluating combination 12/15
Evaluating combination 13/15
Evaluating combination 14/15
Evaluating combination 15/15
The selection with the minimum total H is: {15: {1: 5, 2: 0}, 14: {1: 1, 0: 1, 2: 0}, 16: {0: 3}, 18: {0: 0}, 0: {0: 0}}
After DFS get a Combination:
Candidate molecules respresenting in SMILES: [&#39;O=CCCCc1c2ccccc2cc2ccccc12&#39;, &#39;O=Cc1cc2c(ccc3ccccc32)cn1&#39;, &#39;O=Cc1ccnc2cc3ccccc3cc12&#39;, &#39;O=Cc1cncc2ccc3ccccc3c12&#39;, &#39;O=CCCc1c2ccccc2cc2ccccc12&#39;, &#39;OCCCc1ccnc2ccc3ccccc3c12&#39;, &#39;c1ccc2c(c1)ccc1ccccc12&#39;, &#39;C1(C=CC=C2C=C3)=C2C(C3=CC=C4)=C4C=C1&#39;, &#39;C1(C=CC=C2C=C3)=C2C(C3=CC=C4)=C4C=C1&#39;, &#39;C1(C(C=CC=C2)=C2C3=C4CC=C3)=C4C=CC=C1&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
Total atom counts: {&#39;C&#39;: 199, &#39;H&#39;: 0, &#39;O&#39;: 6, &#39;N&#39;: 4, &#39;S&#39;: 0}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_19_8.png" src="../_images/examples_bitumite_19_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
加丙烷前后
[&#39;O=CCCCc1c2ccccc2cc2ccccc12&#39;, &#39;O=Cc1cc2c(ccc3ccccc32)cn1&#39;, &#39;O=Cc1ccnc2cc3ccccc3cc12&#39;, &#39;O=Cc1cncc2ccc3ccccc3c12&#39;, &#39;O=CCCc1c2ccccc2cc2ccccc12&#39;, &#39;OCCCc1ccnc2ccc3ccccc3c12&#39;, &#39;c1ccc2c(c1)ccc1ccccc12&#39;, &#39;C1(C=CC=C2C=C3)=C2C(C3=CC=C4)=C4C=C1&#39;, &#39;C1(C=CC=C2C=C3)=C2C(C3=CC=C4)=C4C=C1&#39;, &#39;C1(C(C=CC=C2)=C2C3=C4CC=C3)=C4C=CC=C1&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
[&#39;O=C1CCCC(Cc2c3ccccc3cc3ccccc23)C1&#39;, &#39;O=C1CCCc2c1ncc1ccc3ccccc3c21&#39;, &#39;O=C1CCCc2cnc3cc4ccccc4cc3c21&#39;, &#39;O=C1CCCc2ncc3ccc4ccccc4c3c21&#39;, &#39;O=C1CCCC(c2c3ccccc3cc3ccccc23)C1&#39;, &#39;OCCCc1ccnc2ccc3ccccc3c12&#39;, &#39;c1ccc2c(c1)ccc1ccccc12&#39;, &#39;C1(C=CC=C2C=C3)=C2C(C3=CC=C4)=C4C=C1&#39;, &#39;C1(C=CC=C2C=C3)=C2C(C3=CC=C4)=C4C=C1&#39;, &#39;C1(C(C=CC=C2)=C2C3=C4CC=C3)=C4C=CC=C1&#39;] [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_19_10.png" src="../_images/examples_bitumite_19_10.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before connect: {&#39;C&#39;: 33, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 35, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 33, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 35, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 33, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 35, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 37, &#39;H&#39;: 0, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 39, &#39;H&#39;: 0, &#39;O&#39;: 2, &#39;N&#39;: 1, &#39;S&#39;: 0}
Before connect: {&#39;C&#39;: 35, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 0, &#39;S&#39;: 0}, After connect: {&#39;C&#39;: 37, &#39;H&#39;: 0, &#39;O&#39;: 1, &#39;N&#39;: 0, &#39;S&#39;: 0}
Remaining &#39;C&#39; in list2: 18
methane_count:28
SMILES component list: {&#39;C&#39;: 199, &#39;H&#39;: 0, &#39;O&#39;: 6, &#39;N&#39;: 4, &#39;S&#39;: 0}
连接前的检查 {&#39;C&#39;: 199, &#39;H&#39;: 0, &#39;O&#39;: 6, &#39;N&#39;: 4, &#39;S&#39;: 0}
Predicted SMILES is CC1CCc2cnc3cc4cc5c(cc4cc3c2C1=O)Cc1c2c(c3c(C4CCC(C)C(=O)C4C4CCc6ncc7c8c(c9ccc%10c(c9c7c6C4=O)Cc4c(cc6ccc7cccc9ccc4c6c79)C%10)CCCC8C4C(=O)C(OCC6CCCCC6c6ccnc7ccc8c9c(ccc8c67)Cc6c(ccc7c6c6c(c8ccccc87)CC=C6)C9)CCC4Cc4c6ccccc6cc6c7c(ccc46)Cc4c(c6ccccc6c6ccccc46)C7)c4ccccc4cc3c1C5)C(C1c3ccc4ccc5cnc6c(c5c4c3Cc3cc4ccc5cccc7ccc(c31)c4c57)CC1CCCCC1C6=O)CCC2
Predicted Chemical Fomula of final coal model is C199H0O6N4S0
不饱和碳原子数量: 147
Unsatutated carbon rate of final coal model is 0.7386934673366834
Predicted elemental ratio of coal model is: {&#39;C&#39;: 94.01895335617597, &#39;H&#39;: 0.0, &#39;O&#39;: 3.7765093252243287, &#39;N&#39;: 2.204537318599702, &#39;S&#39;: 0.0}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">current_smiles_list</span><span class="p">:</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">drawMolecule</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="c1"># # 根据smiles画分子图</span>
<span class="c1"># from rdkit import Chem</span>
<span class="c1"># from rdkit.Chem import Draw</span>
<span class="c1"># from rdkit.Chem import AllChem  # 用于添加氢原子</span>
<span class="c1"># from rdkit.Chem.Draw import IPythonConsole</span>

<span class="c1"># # 假设 current_smiles_list 已经定义并包含了SMILES字符串</span>
<span class="c1"># smiles_list = current_smiles_list</span>

<span class="c1"># for smiles in smiles_list:</span>
<span class="c1">#     print(smiles)</span>
<span class="c1">#     mol = Chem.MolFromSmiles(smiles, sanitize=False)  # 创建分子时不进行sanitize操作</span>
<span class="c1">#</span>

<span class="c1">#     img = Draw.MolToImage(mol, size=(600, 600))</span>
<span class="c1">#     img.show()</span>
<span class="c1">#     ut.calculate_unsaturated_carbon_ratio(smiles)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_20_0.png" src="../_images/examples_bitumite_20_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_bitumite_20_1.png" src="../_images/examples_bitumite_20_1.png" />
</div>
</div>
</section>
<section id="checking-revised-molecule-model">
<h2>checking revised molecule model<a class="headerlink" href="#checking-revised-molecule-model" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratio</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">calculate_unsaturated_carbon_ratio</span><span class="p">(</span><span class="s2">&quot;CC1CCc(c(C1=O)cc2)c3c2c4c(Cc(cc5)c(C4)c6c5c7c(C(CC(C7=O)C8CCc(cn9)c(C8=O)c</span><span class="si">%10c</span><span class="s2">9c</span><span class="si">%11c</span><span class="s2">(C(c(c%12)c(C%11)cc</span><span class="si">%13c%12c%14c</span><span class="s2">(CCC(C%14=O)C%15CCC(C(C%15=O)C)c(cc%16)cc</span><span class="si">%17c%16c%18c</span><span class="s2">(Cc(c(C%18)c(COC%19CCc(cc%20)c(C%19=O)c</span><span class="si">%21c%20c</span><span class="s2">c</span><span class="si">%22c</span><span class="s2">(Cc(c(C%22)cc%23)c</span><span class="si">%24c%23c</span><span class="s2">ccc%24C(C%25CCC(C(C%25C%26CCc(c(C%26=O)c</span><span class="si">%27c</span><span class="s2">%28Cc(c%29)c(C%27)cc</span><span class="si">%30c%29c</span><span class="s2">(CC%31CCC(C(C%31C)=O)C)cc</span><span class="si">%32c</span><span class="s2">%30CCCC%32)c</span><span class="si">%33c%28c</span><span class="s2">ccc%33)=O)OCC%34CCCCC</span><span class="si">%34c%35c</span><span class="s2">(Cc(c(C%36)cc%37)c</span><span class="si">%38c%37c</span><span class="s2">cc(C%39CCC(C(C%39C)=O)C)c%38)c%36ncc%35)C)c%21)n%40)c</span><span class="si">%41c%40c%42c</span><span class="s2">(CCCC%42)cc%41)cc%17)cn%13)C)cc%10)C)nc6)cc3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsatutated carbon rate of final coal model is&quot;</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to GenCoal’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lignite.html" class="btn btn-neutral float-right" title="lignite" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Haodong Liu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>