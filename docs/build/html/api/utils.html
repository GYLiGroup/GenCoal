

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>utils Module &mdash; GenCoal v1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=0ec76b63"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="main Module" href="main.html" />
    <link rel="prev" title="CoalGenerator Module" href="CoalGenerator.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GenCoal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/bitumite.html">bitumite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/lignite.html">lignite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ClipIRMol.html">ClipIRMol Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoalGenerator.html">CoalGenerator Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">utils Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.ad2daf"><code class="docutils literal notranslate"><span class="pre">ad2daf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.backtrack_combinations"><code class="docutils literal notranslate"><span class="pre">backtrack_combinations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.balance_c_and_n_atoms"><code class="docutils literal notranslate"><span class="pre">balance_c_and_n_atoms()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.balance_o_and_s_atoms"><code class="docutils literal notranslate"><span class="pre">balance_o_and_s_atoms()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.build_H_nested_dict"><code class="docutils literal notranslate"><span class="pre">build_H_nested_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.calculate_C90_C180"><code class="docutils literal notranslate"><span class="pre">calculate_C90_C180()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.calculate_MA"><code class="docutils literal notranslate"><span class="pre">calculate_MA()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.calculate_element_moles"><code class="docutils literal notranslate"><span class="pre">calculate_element_moles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.calculate_mass_percentages"><code class="docutils literal notranslate"><span class="pre">calculate_mass_percentages()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.calculate_unsaturated_carbon_ratio"><code class="docutils literal notranslate"><span class="pre">calculate_unsaturated_carbon_ratio()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.connect_molecules"><code class="docutils literal notranslate"><span class="pre">connect_molecules()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.connect_rings"><code class="docutils literal notranslate"><span class="pre">connect_rings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.connect_rings_C3"><code class="docutils literal notranslate"><span class="pre">connect_rings_C3()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.connect_rings_C4"><code class="docutils literal notranslate"><span class="pre">connect_rings_C4()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.count_atoms"><code class="docutils literal notranslate"><span class="pre">count_atoms()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.count_hydroxy_oxygen"><code class="docutils literal notranslate"><span class="pre">count_hydroxy_oxygen()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.count_ketone_carbons"><code class="docutils literal notranslate"><span class="pre">count_ketone_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.count_property"><code class="docutils literal notranslate"><span class="pre">count_property()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.daf2ad"><code class="docutils literal notranslate"><span class="pre">daf2ad()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.drawMolecule"><code class="docutils literal notranslate"><span class="pre">drawMolecule()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.drawMolecules"><code class="docutils literal notranslate"><span class="pre">drawMolecules()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_C4_carbons"><code class="docutils literal notranslate"><span class="pre">find_C4_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_aldehyde_carbons"><code class="docutils literal notranslate"><span class="pre">find_aldehyde_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_aliphatic_carbons"><code class="docutils literal notranslate"><span class="pre">find_aliphatic_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_alpha_carbons"><code class="docutils literal notranslate"><span class="pre">find_alpha_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_atom_indices"><code class="docutils literal notranslate"><span class="pre">find_atom_indices()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_ban_carbons"><code class="docutils literal notranslate"><span class="pre">find_ban_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_benzene_carbons"><code class="docutils literal notranslate"><span class="pre">find_benzene_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_beta_carbons"><code class="docutils literal notranslate"><span class="pre">find_beta_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_combinations"><code class="docutils literal notranslate"><span class="pre">find_combinations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_hydroxy_oxygen"><code class="docutils literal notranslate"><span class="pre">find_hydroxy_oxygen()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_ketone_alpha_carbons"><code class="docutils literal notranslate"><span class="pre">find_ketone_alpha_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_matching_indices"><code class="docutils literal notranslate"><span class="pre">find_matching_indices()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_min_H_selection"><code class="docutils literal notranslate"><span class="pre">find_min_H_selection()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_required_aldehyde_carbons"><code class="docutils literal notranslate"><span class="pre">find_required_aldehyde_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.find_required_carbons"><code class="docutils literal notranslate"><span class="pre">find_required_carbons()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.generate_candidate_smiles"><code class="docutils literal notranslate"><span class="pre">generate_candidate_smiles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.getPackage"><code class="docutils literal notranslate"><span class="pre">getPackage()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.getTarget"><code class="docutils literal notranslate"><span class="pre">getTarget()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.merge_count_atoms"><code class="docutils literal notranslate"><span class="pre">merge_count_atoms()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.parallel_backtrack_combinations"><code class="docutils literal notranslate"><span class="pre">parallel_backtrack_combinations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.process_smiles"><code class="docutils literal notranslate"><span class="pre">process_smiles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.read_json"><code class="docutils literal notranslate"><span class="pre">read_json()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.recommended_carbonyl_hydroxyl"><code class="docutils literal notranslate"><span class="pre">recommended_carbonyl_hydroxyl()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.repeat_connect_rings_C4"><code class="docutils literal notranslate"><span class="pre">repeat_connect_rings_C4()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.select_carbons_from_different_rings"><code class="docutils literal notranslate"><span class="pre">select_carbons_from_different_rings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.show_atom_number"><code class="docutils literal notranslate"><span class="pre">show_atom_number()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.show_ring_carbon_numbers"><code class="docutils literal notranslate"><span class="pre">show_ring_carbon_numbers()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coal.utils.update_smiles_lists"><code class="docutils literal notranslate"><span class="pre">update_smiles_lists()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="main.html">main Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GenCoal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">utils Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-coal.utils">
<span id="utils-module"></span><h1>utils Module<a class="headerlink" href="#module-coal.utils" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.ad2daf">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">ad2daf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#coal.utils.ad2daf" title="Permalink to this definition"></a></dt>
<dd><p>Converts the element percentages from the AD (as-determined) basis to the DAF (dry, ash-free) basis.</p>
<p>This function calculates the percentage of each element (C, N, H, S, and O) on the DAF basis,
given their values on the AD basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<em>float</em>) – Carbon percentage in the AD basis.</p></li>
<li><p><strong>N</strong> (<em>float</em>) – Nitrogen percentage in the AD basis.</p></li>
<li><p><strong>H</strong> (<em>float</em>) – Hydrogen percentage in the AD basis.</p></li>
<li><p><strong>S</strong> (<em>float</em>) – Sulfur percentage in the AD basis.</p></li>
<li><p><strong>M</strong> (<em>float</em>) – Moisture percentage (unused in calculations but might be part of input data).</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Ash percentage (unused in calculations but might be part of input data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the percentages of Carbon (C), Nitrogen (N), Hydrogen (H), Sulfur (S),
and Oxygen (O) on the DAF basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.backtrack_combinations">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">backtrack_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nested_dict_H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection_dic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_O_S</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.backtrack_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Finds valid combinations of hydrogen (H) counts that match a specified target for oxygen-sulfur (O_S) count
using a backtracking algorithm. This function explores all possible combinations of H and O_S values to
find combinations that meet the target O_S sum and the required hydrogen counts specified in <cite>selection_dic</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nested_dict_H</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – A nested dictionary where the first level keys are hydrogen counts (H) and the second level keys are
oxygen-sulfur counts (O_S). The values are the available counts for each hydrogen (H) and oxygen-sulfur (O_S) combination.</p></li>
<li><p><strong>selection_dic</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – A dictionary where the keys represent hydrogen counts (H) and the values represent the total number of times
each hydrogen count must be used in the final solution.</p></li>
<li><p><strong>target_O_S</strong> (<em>int</em>) – The target sum of oxygen-sulfur (O_S) values that the selected combinations of H and O_S should match.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum depth to which the backtracking algorithm will explore. Default is 30. This helps control the recursion depth
and avoid excessive computation for large inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, where each dictionary represents a valid combination of hydrogen (H) and oxygen-sulfur (O_S)
values that satisfy the target O_S sum and adhere to the required hydrogen counts as specified in <cite>selection_dic</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[int, Dict[int, int]]]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nested_dict_H</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mi">12</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selection_dic</span> <span class="o">=</span> <span class="p">{</span><span class="mi">12</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_O_S</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">backtrack_combinations</span><span class="p">(</span><span class="n">nested_dict_H</span><span class="p">,</span> <span class="n">selection_dic</span><span class="p">,</span> <span class="n">target_O_S</span><span class="p">)</span>
<span class="go">[{&#39;12&#39;: {2: 1, 3: 1}, &#39;8&#39;: {2: 1}}]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function employs a depth-first search (DFS) approach to explore potential combinations and uses memoization
to avoid recomputing previously explored paths.</p></li>
<li><p>If a solution exceeds the <cite>max_depth</cite>, the function will stop further exploration.</p></li>
<li><p>The function returns multiple valid solutions if they exist.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.balance_c_and_n_atoms">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">balance_c_and_n_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_element_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.balance_c_and_n_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Modifies a molecule by replacing carbon atoms with nitrogen to meet target element counts,
while avoiding changes in benzene rings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – SMILES representation of the molecule.</p></li>
<li><p><strong>target_element_counts</strong> (<em>dict</em>) – Dictionary with target counts for elements, e.g., {‘C’: x, ‘N’: y}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_smiles</strong> – A new SMILES string of the modified molecule, or the original SMILES if the desired modifications cannot be made.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.balance_o_and_s_atoms">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">balance_o_and_s_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_element_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.balance_o_and_s_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Modifies a molecule by replacing sulfur atoms with oxygen, or vice versa,
to meet target element counts for oxygen and sulfur.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – SMILES representation of the molecule.</p></li>
<li><p><strong>target_element_counts</strong> (<em>dict</em>) – Dictionary with target counts for oxygen (‘O’) and sulfur (‘S’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new SMILES string of the modified molecule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.build_H_nested_dict">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">build_H_nested_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sorted_choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.build_H_nested_dict" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a nested dictionary to store the minimum hydrogen (H) values for combinations
of carbon-nitrogen aromatic count (C_N_ar) and oxygen-sulfur count (O_S) from a list of compounds.</p>
<p>The function iterates over the provided list of compound data (sorted_choices) and for each
unique combination of C_N_ar (carbon-nitrogen aromatic count) and O_S (oxygen-sulfur count),
it records the minimum hydrogen (H) value. The result is stored in a nested dictionary format
where the first level keys are ‘C_N_ar’ values, the second level keys are ‘O_S’ values, and
the values are the minimum ‘H’ values for those combinations.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_choices</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_H_nested_dict</span><span class="p">(</span><span class="n">sorted_choices</span><span class="p">)</span>
<span class="go">{10: {2: 8}, 5: {3: 14}}</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function assumes that the input list (<cite>sorted_choices</cite>) is pre-sorted by ‘C_N_ar’ and ‘O_S’ values.</p></li>
<li><p>If multiple entries have the same C_N_ar and O_S values, the function will select the minimum H value from those entries.</p></li>
<li><p>The function is designed to handle situations where not all combinations of C_N_ar and O_S are present,
in which case those combinations will not appear in the output dictionary.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.calculate_C90_C180">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_C90_C180</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.calculate_C90_C180" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the integral ratios C90 and C180 from NMR data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – Path to the CSV file containing NMR data with columns ‘X’ and ‘Y’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ratios C90 and C180.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.calculate_MA">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_MA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_ad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_ad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_ad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_ad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#coal.utils.calculate_MA" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the sum of moisture (M) and ash (A) content based on the element percentages
in the AD (as-determined) basis and DAF (dry, ash-free) basis for a given material.</p>
<p>This function computes the total moisture and ash content (M + A) based on the known
values of carbon, nitrogen, hydrogen, sulfur, and oxygen in both AD and DAF forms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_ad</strong> (<em>float</em>) – Carbon percentage in the AD basis.</p></li>
<li><p><strong>N_ad</strong> (<em>float</em>) – Nitrogen percentage in the AD basis.</p></li>
<li><p><strong>H_ad</strong> (<em>float</em>) – Hydrogen percentage in the AD basis.</p></li>
<li><p><strong>S_ad</strong> (<em>float</em>) – Sulfur percentage in the AD basis.</p></li>
<li><p><strong>C_daf</strong> (<em>float</em>) – Carbon percentage in the DAF basis.</p></li>
<li><p><strong>O_daf</strong> (<em>float</em>) – Oxygen percentage in the DAF basis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sum of moisture and ash content (M + A) on the AD basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Given the following input data:</p>
<p>C_ad = 80.92
N_ad = 3.49   # Nitrogen
H_ad = 3.03   # Hydrogen
S_ad = 0.38   # Sulfur
C_daf = 83.86
O_daf = 8.99</p>
<p>The function is called as:</p>
<p>MA_sum = calculate_MA(C_ad, N_ad, H_ad, S_ad, C_daf, O_daf)</p>
<p>The output will be:</p>
<p>MA_sum: 8.29</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.calculate_element_moles">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_element_moles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_moles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ele_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#coal.utils.calculate_element_moles" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the moles of each element in a compound based on the moles of carbon (C)
and the mass percentage ratios of other elements relative to carbon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_moles</strong> (<em>float</em>) – The carbon counts in the compound.</p></li>
<li><p><strong>ele_ratio</strong> (<em>dict</em>) – Elemental percentage (e.g., {‘C’: 80, ‘H’: 10, ‘O’: 10}).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of each element in the compound.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.calculate_mass_percentages">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_mass_percentages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#coal.utils.calculate_mass_percentages" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the mass percentages of elements based on their counts in a molecule.</p>
<p>This function uses the atomic masses of carbon, hydrogen, oxygen, nitrogen, and sulfur to compute
the mass percentages of each element in the molecule, given the counts of each element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atom_counts</strong> (<em>dict</em><em> of </em><em>{str: int}</em>) – A dictionary with element symbols as keys (e.g., ‘C’, ‘H’, ‘O’) and their counts in the molecule as values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dict of {str</strong> – A dictionary with element symbols as keys and their mass percentages as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.calculate_unsaturated_carbon_ratio">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_unsaturated_carbon_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#coal.utils.calculate_unsaturated_carbon_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the ratio of unsaturated carbon atoms (participating in double or triple bonds)
to the total number of carbon atoms in a molecule represented by a SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – SMILES representation of the molecule.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The ratio of unsaturated carbon atoms to total carbon atoms in the molecule.
Returns 0 if there are no carbon atoms in the molecule or if the input SMILES is invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.connect_molecules">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">connect_molecules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.connect_molecules" title="Permalink to this definition"></a></dt>
<dd><p>Connects two molecules at suitable bonding positions, based on various functional groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles1</strong> (<em>str</em>) – The SMILES string representing the first molecule.</p></li>
<li><p><strong>smiles2</strong> (<em>str</em>) – The SMILES string representing the second molecule to be connected.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The SMILES string representing the combined molecule if a valid connection is made,
or None if no valid connection can be found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.connect_rings">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">connect_rings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecules_tuple_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.connect_rings" title="Permalink to this definition"></a></dt>
<dd><p>Connects two rings from a list of molecule tuples by adding two methane groups between them.</p>
<p>This function takes a list of molecule tuples, where each tuple contains a SMILES string
representing a molecule and a list of indices of carbon atoms that can be used for connection.
It selects one pair of carbon atoms from each molecule and connects them by adding two methane
groups at the chosen positions. The final connected molecule is then returned as a SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecules_tuple_list</strong> (<em>list</em><em> of </em><em>tuples</em>) – A list where each tuple contains:
- A SMILES string representing a molecule.
- A list of integers, where each integer is an index of a carbon atom that is available for connection.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new SMILES string representing the connected molecule structure. If the input list is invalid (less than 2 molecules),
an error message is returned instead.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecules</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;C1CCCC1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;C1CCCCC1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connect_rings</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span>
<span class="go">&#39;CC1CC(C)C(C)C1&#39;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function selects a pair of carbon atoms from each molecule and connects them by adding two methane groups between them.</p></li>
<li><p>The function relies on the <cite>_find_index_pairs</cite> and <cite>_connect_ring_C</cite> functions for finding suitable carbon pairs and connecting the molecules.</p></li>
<li><p>If there is less than two molecules in the input list, an appropriate message is returned.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.connect_rings_C3">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">connect_rings_C3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.connect_rings_C3" title="Permalink to this definition"></a></dt>
<dd><p>Connects a given molecule with a propane molecule at identified beta carbon positions.</p>
<p>This function takes an initial molecule represented by a SMILES string and connects it to a propane molecule
(‘CCC’) at the beta carbon positions identified in the initial molecule. If suitable beta carbon atoms
(those that are part of aldehyde groups) are found, it adds a propane unit at those positions and returns
the modified molecule as a new SMILES string. If no suitable positions are found, it returns None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles1</strong> (<em>str</em>) – A SMILES string representing the initial molecule to which propane will be connected.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SMILES string representing the modified molecule after connection with propane.
If no suitable carbon atoms are found for the connection, returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">connect_rings_C3</span><span class="p">(</span><span class="s1">&#39;CC(=O)C&#39;</span><span class="p">)</span>
<span class="go">&#39;CC(=O)CCC&#39;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function uses the RDKit library to manipulate molecular structures.</p></li>
<li><p>The propane molecule is added at the beta carbon positions found in the input molecule.</p></li>
<li><p>If no suitable aldehyde carbon atoms (those that can be connected to propane) are found, the function will print
a message and return None.</p></li>
<li><p>The function assumes that the propane molecule (‘CCC’) can be directly connected to the identified positions
without additional steric or electronic considerations.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.connect_rings_C4">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">connect_rings_C4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.connect_rings_C4" title="Permalink to this definition"></a></dt>
<dd><p>Connects a given molecule with a butane molecule at specified carbon atom positions.</p>
<p>This function finds carbon atoms in the input molecule (represented by its SMILES string)
that meet the criteria for connecting to a butane molecule at its terminal carbons.
If suitable carbon atoms are found, the butane molecule is connected, and the resulting
molecule is returned as a SMILES string. If no suitable carbon atoms are found,
it returns None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles1</strong> (<em>str</em>) – A SMILES string representing the initial molecule to which butane will be connected.
The function will attempt to identify specific carbon atoms in this molecule for the connection.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SMILES string representing the modified molecule after connecting with butane.
If no suitable carbon atoms are found for the connection, returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smiles1</span> <span class="o">=</span> <span class="s1">&#39;CC(C)C&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connect_rings_C4</span><span class="p">(</span><span class="n">smiles1</span><span class="p">)</span>
<span class="go">&#39;CC(C)CCCC&#39;  # Example output, depending on the initial molecule</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses the <cite>find_C4_carbons</cite> function to identify potential carbon atoms in the
input molecule that are suitable for bonding with butane. These atoms must meet specific
bonding criteria (bonded to two carbons or nitrogens and one or two hydrogens).</p></li>
<li><p>The function attempts to connect the molecule to butane (a four-carbon chain, SMILES: ‘CCCC’).</p></li>
<li><p>The connection is made by bonding the terminal carbons of butane to two carbon atoms from
the original molecule.</p></li>
<li><p>If no suitable pair of carbon atoms for bonding is found, the function prints a message
and returns None.</p></li>
<li><p>The function utilizes RDKit to perform molecule manipulation and bonding.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.count_atoms">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">count_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#coal.utils.count_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of each specified element in a single SMILES string or a list of SMILES strings.
Ensures all expected elements are included in the result dictionary, even if their count is 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_input</strong> (<em>str</em><em> or </em><em>list</em>) – A single SMILES string or a list of SMILES strings representing molecule(s).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with element symbols as keys and their total counts across all input molecules as values.
Includes ‘C’, ‘H’, ‘O’, ‘N’, and ‘S’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.count_hydroxy_oxygen">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">count_hydroxy_oxygen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#coal.utils.count_hydroxy_oxygen" title="Permalink to this definition"></a></dt>
<dd><p>计算一个 SMILES 字符串列表中所有分子中的羟基氧（OH）原子的总数。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_list</strong> – SMILES 字符串的列表</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>羟基氧（OH）原子的总数</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.count_ketone_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">count_ketone_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#coal.utils.count_ketone_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Counts the total number of ketone carbon atoms in a list of molecules represented by SMILES strings.</p>
<p>A ketone carbon atom is defined as a carbon atom that is double-bonded to an oxygen atom and is not part of an aldehyde or carboxyl group.</p>
<p>This function iterates over the provided list of SMILES strings, converts each molecule to an RDKit molecule object,
adds explicit hydrogen atoms to the molecule structure (if not already present), and identifies carbon atoms that are
part of ketone functional groups. The total count of such carbon atoms is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list containing SMILES strings of the molecules to analyze. Each string represents a molecule.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>total_count</strong> – The total count of ketone carbon atoms across all molecules in the given list.
A ketone carbon is a carbon atom double-bonded to an oxygen atom.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC(=O)C&#39;</span><span class="p">,</span> <span class="s1">&#39;C1CC(=O)C1&#39;</span><span class="p">,</span> <span class="s1">&#39;CC(C(=O)C)C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_ketone_carbons</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses RDKit to parse the SMILES strings and explicitly adds hydrogen atoms to the molecule to ensure
the bonds are correctly interpreted.</p></li>
<li><p>Ketone carbons are identified based on the presence of a double bond between a carbon atom and an oxygen atom.</p></li>
<li><p>This function does not distinguish between ketones and other carbonyl compounds (such as aldehydes or carboxylic acids)
because it looks for a carbon double-bonded to an oxygen atom without further specificity.</p></li>
<li><p>This function is useful for counting ketone functional groups in molecules.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.count_property">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">count_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coal.utils.count_property" title="Permalink to this definition"></a></dt>
<dd><p>Counts specified elements and their types (e.g., unsaturated or aliphatic carbons) in one or more SMILES strings.</p>
<p>Specifically counts:
- ‘C_N_ar’: Unsaturated carbon or nitrogen atoms (those participating in double or triple bonds).
- ‘C_al’: Aliphatic (single-bonded) carbon atoms.
- ‘O_S’: Oxygen and sulfur atoms.
- ‘H’: Hydrogen atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_input</strong> (<em>str</em><em> or </em><em>list</em>) – A single SMILES string or a list of SMILES strings representing one or more molecules.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with the counts of each property: {‘C_N_ar’, ‘C_al’, ‘O_S’, ‘H’}.
The counts reflect the number of atoms of each type found in the provided molecule(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.daf2ad">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">daf2ad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O_daf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#coal.utils.daf2ad" title="Permalink to this definition"></a></dt>
<dd><p>Converts the element percentages from the DAF (dry, ash-free) basis to the AD (as-determined) basis.</p>
<p>This function calculates the percentage of each element (C, N, H, S, and O) on the AD basis,
given their values on the DAF basis, and considering moisture and ash content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_daf</strong> (<em>float</em>) – Carbon percentage in the DAF basis.</p></li>
<li><p><strong>N_daf</strong> (<em>float</em>) – Nitrogen percentage in the DAF basis.</p></li>
<li><p><strong>H_daf</strong> (<em>float</em>) – Hydrogen percentage in the DAF basis.</p></li>
<li><p><strong>S_daf</strong> (<em>float</em>) – Sulfur percentage in the DAF basis.</p></li>
<li><p><strong>O_daf</strong> (<em>float</em>) – Oxygen percentage in the DAF basis.</p></li>
<li><p><strong>M</strong> (<em>float</em>) – Moisture percentage.</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Ash percentage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the percentages of Carbon (C), Nitrogen (N), Hydrogen (H), Sulfur (S),
and Oxygen (O) on the AD basis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Given the following input data:</p>
<p>C_daf = 83.96
N_daf = 3.81
H_daf = 3.31
S_daf = 0.39
O_daf = 8.99
M = 2.51  # Moisture
A = 1.66  # Ash</p>
<p>The function is called as:</p>
<p>C_ad, N_ad, H_ad, S_ad, O_ad = daf2ad(C_daf, N_daf, H_daf, S_daf, O_daf, M, A)</p>
<p>The output will be:</p>
<p>ad基准下百分比: C_ad, N_ad, H_ad, S_ad, O_ad
CNHSOMA和: C_ad + N_ad + H_ad + S_ad + O_ad + M + A</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.drawMolecule">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">drawMolecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#coal.utils.drawMolecule" title="Permalink to this definition"></a></dt>
<dd><p>Draws a molecule from a given SMILES string and displays the image.</p>
<p>This function uses RDKit to create a molecule object from the provided SMILES string
and then generates an image of the molecule, which is displayed using the default image viewer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – The SMILES string representing the molecule to be drawn.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This function does not return a value, it directly displays the molecule’s image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.drawMolecules">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">drawMolecules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molsPerRow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxMols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.drawMolecules" title="Permalink to this definition"></a></dt>
<dd><p>Draws a grid image of molecules from a list of SMILES strings.</p>
<p>This function takes a list of SMILES strings, converts them into RDKit molecule objects, and generates a grid image.
It also provides a summary of the molecular properties (C, N, O, H counts) for each molecule in the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list of SMILES strings representing the molecules to be drawn.</p></li>
<li><p><strong>molsPerRow</strong> (<em>int</em>) – The number of molecules to display per row in the grid image.</p></li>
<li><p><strong>maxMols</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=100</em>) – The maximum number of molecules to display in the grid. If more molecules are provided, they will be truncated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, each containing molecular property counts (C, N, O, H) for each molecule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_C4_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_C4_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_C4_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies carbon atoms in a molecule that are bonded to exactly two carbon or nitrogen atoms
and have one or two hydrogen atoms.</p>
<p>The function iterates over the atoms in the molecule, checks if a carbon atom meets the bonding
criteria (bonded to two carbon or nitrogen atoms and one or two hydrogen atoms), and returns
a list of the indices of such carbon atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – A SMILES string representing the molecular structure to be analyzed.
The string encodes the connectivity of atoms and bonds within the molecule.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices corresponding to carbon atoms that meet the specified bonding criteria
within the molecule. Atom indices are zero-based, corresponding to the order in which atoms
appear in the RDKit molecule object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smiles</span> <span class="o">=</span> <span class="s1">&#39;CC(C)C&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_C4_carbons</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses RDKit to convert the SMILES string into a molecule object and explicitly
adds hydrogen atoms to ensure accurate bond interpretation.</p></li>
<li><dl class="simple">
<dt>The criteria for selecting carbon atoms are:</dt><dd><ol class="arabic simple">
<li><p>The atom must be bonded to exactly two carbon or nitrogen atoms.</p></li>
<li><p>The atom must have one or two hydrogen atoms bonded to it.</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>This function is useful for identifying specific carbon atoms that fit certain structural
patterns, such as those in substituted hydrocarbons or nitrogen-containing compounds.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_aldehyde_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_aldehyde_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_aldehyde_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies aldehyde carbon atoms within a given molecule.</p>
<p>An aldehyde group consists of a carbonyl group (C=O) where the carbon is bonded to a hydrogen atom (–CHO).
This function checks for carbon atoms that are part of such a group by looking for a carbon
bonded to one oxygen atom with a double bond and one hydrogen atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – The RDKit molecule object to be analyzed. This molecule will be checked for aldehyde groups.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>aldehyde_carbons</strong> – A list of indices corresponding to carbon atoms that are part of an aldehyde group within the molecule.
Atom indices are zero-based, matching the order in which atoms appear in the RDKit molecule object.
If no aldehyde groups are found, the list will be empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(C)C=O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_aldehyde_carbons</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[4]  # The carbon in the aldehyde group is at index 4.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function explicitly adds hydrogen atoms to the molecule for more accurate analysis of aldehyde groups.</p></li>
<li><p>The function checks for a carbon atom bonded to one oxygen atom (double bond) and one hydrogen atom,
indicative of an aldehyde group.</p></li>
<li><p>Only carbon atoms that meet these criteria are included in the result list.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_aliphatic_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_aliphatic_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_aliphatic_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies indices of aliphatic (non-aromatic) carbon atoms within a given molecule.</p>
<p>Aliphatic carbon atoms are defined as carbon atoms that are not part of an aromatic ring. These include
carbon atoms in chains, branches, or rings that are not aromatic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit molecule object representing the molecule to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices corresponding to aliphatic carbon atoms in the molecule.
Atom indices are zero-based, corresponding to the order in which atoms appear in the RDKit molecule object.
If no aliphatic carbon atoms are found, the list will be empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC1=CC=CC=C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_aliphatic_carbons</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]  # The aliphatic carbons are the ones in the alkyl chain attached to the aromatic ring.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function identifies carbon atoms that are not part of any aromatic ring in the molecule.</p></li>
<li><p>Aliphatic carbons can be in straight chains, branched chains, or non-aromatic rings.</p></li>
<li><p>Aromatic carbons, which are part of rings with alternating single and double bonds (like benzene), are excluded.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_alpha_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_alpha_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_alpha_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies indices of non-aromatic alpha carbon atoms that are directly bonded to aromatic carbon atoms.</p>
<p>Alpha carbon atoms are defined as carbon atoms that are directly bonded to an aromatic carbon atom,
but are themselves not aromatic. These are typically carbons attached to aromatic rings in compounds
like aryl groups attached to alkyl chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit molecule object representing the molecule to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of unique indices for non-aromatic alpha carbon atoms that are directly bonded to aromatic carbon atoms.
Atom indices are zero-based, corresponding to the order in which atoms appear in the RDKit molecule object.
If no such alpha carbons are found, the list will be empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC1=CC=CC=C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_alpha_carbons</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[0, 3]  # The alpha carbons bonded to the aromatic ring at indices 0 and 3.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function identifies non-aromatic carbons bonded to aromatic carbons in molecules with aromatic rings.</p></li>
<li><p>The search excludes aromatic carbons, focusing only on non-aromatic carbons.</p></li>
<li><p>The set data structure is used to avoid duplicate indices for alpha carbons.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_atom_indices">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_atom_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_atom_indices" title="Permalink to this definition"></a></dt>
<dd><p>Returns the indices of specified atoms in a molecule. For oxygen atoms,
it specifically returns those bonded to exactly two carbon atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – SMILES representation of the molecule.</p></li>
<li><p><strong>atom_symbol</strong> (<em>str</em>) – The symbol of the atom to find (‘O’ for oxygen, ‘S’ for sulfur).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices for the specified atoms under the given conditions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_ban_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_ban_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_ban_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies carbon atoms bonded to exactly two hydrogen atoms and not connected to any other carbons.</p>
<p>This function is designed to find carbon atoms in a molecule that are bonded to exactly two hydrogen atoms
and are not bonded to other carbon atoms (i.e., the carbon is isolated or terminal, not part of a longer chain).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit molecule object representing the molecule to be analyzed, before adding explicit hydrogens.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices corresponding to carbon atoms that meet the criteria:
- Bonded to exactly two hydrogen atoms.
- Not connected to any other carbon atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CH3CH2OH&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_ban_carbons</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[0, 3]  # For a molecule like ethanol, the carbon atoms bonded to two hydrogens are indexed.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function first adds explicit hydrogens to the molecule to ensure the number of hydrogen atoms can be counted accurately.</p></li>
<li><p>It considers only carbon atoms that are bonded to exactly two hydrogens and are not connected to other carbons, excluding carbon-carbon bonds.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_benzene_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_benzene_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_benzene_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies indices of carbon atoms that are part of benzene rings in a given molecule.</p>
<p>Benzene rings are identified based on the presence of six carbon atoms that are part of an aromatic system,
where the carbon atoms are involved in alternating single and double bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit molecule object representing the molecule to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices corresponding to carbon atoms that are part of benzene rings in the molecule.
The indices are zero-based, corresponding to the order in which atoms appear in the RDKit molecule object.
If no benzene rings are found, the list will be empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;C1=CC=CC=C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_benzene_carbons</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5]  # The carbon atoms in the benzene ring.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Benzene rings are detected by finding rings with exactly six carbon atoms that are aromatic.</p></li>
<li><p>The function returns a list of indices for the carbon atoms in the benzene ring, excluding other atoms or rings.</p></li>
<li><p>The output list may contain duplicates if the molecule contains multiple benzene rings, which are then removed by converting the list to a set.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_beta_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_beta_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_beta_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies pairs of aldehyde (carbonyl) carbon atoms and their beta carbon atoms in a molecule.</p>
<p>This function finds aldehyde carbon atoms (part of a carbonyl group) and identifies the beta carbon atoms
that are bonded to them. Beta carbon atoms are those directly bonded to an alpha carbon, which is
directly bonded to the aldehyde carbon. The function returns a list of tuples where each tuple contains
the index of an aldehyde carbon atom and the index of a corresponding beta carbon atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – A SMILES string representing the molecular structure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tuples where each tuple contains two integers. The first integer is the index of an aldehyde carbon atom,
and the second is the index of a corresponding beta carbon atom that is bonded to at least one hydrogen atom.
Atom indices are zero-based and correspond to the order in which atoms appear in the RDKit molecule object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_beta_carbons</span><span class="p">(</span><span class="s1">&#39;CC(=O)C&#39;</span><span class="p">)</span>
<span class="go">[(1, 0)]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function identifies aldehyde (carbonyl) carbon atoms and traces their alpha and beta carbons.</p></li>
<li><p>The beta carbon is selected only if it is bonded to at least one hydrogen atom, ensuring that it is a valid beta carbon.</p></li>
<li><p>This function is useful in organic chemistry when looking for specific structural motifs around aldehyde groups.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_combinations">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sorted_choices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_C_N_ar</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coal.utils.find_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Finds all unique combinations of ‘C_N_ar’ values from ‘sorted_choices’ that sum up to ‘target_C_N_ar’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sorted_choices</strong> (<em>list</em><em> of </em><em>dicts</em>) – A list of dictionaries where each dictionary contains ‘C_N_ar’ among other keys.
This list represents different choices or options, each with a specified ‘C_N_ar’ value.</p></li>
<li><p><strong>target_C_N_ar</strong> (<em>int</em>) – The target sum of ‘C_N_ar’ values for the combinations to reach.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list where each dictionary represents a unique combination of ‘C_N_ar’ values that sum up to ‘target_C_N_ar’. The keys in each dictionary are the ‘C_N_ar’ values used, and the values are the counts of each ‘C_N_ar’ value in the combination.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dicts</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_choices</span> <span class="o">=</span> <span class="p">[</span>
<span class="go">    {&#39;C_N_ar&#39;: 2, &#39;O_S&#39;: 3, &#39;H&#39;: 7},</span>
<span class="go">    {&#39;C_N_ar&#39;: 3, &#39;O_S&#39;: 2, &#39;H&#39;: 6},</span>
<span class="go">    {&#39;C_N_ar&#39;: 5, &#39;O_S&#39;: 1, &#39;H&#39;: 8}</span>
<span class="go">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_combinations</span><span class="p">(</span><span class="n">sorted_choices</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[{2: 1, 3: 1}, {5: 1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_hydroxy_oxygen">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_hydroxy_oxygen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_hydroxy_oxygen" title="Permalink to this definition"></a></dt>
<dd><p>Identifies the indices of hydroxy oxygen and sulfur atoms in a given RDKit molecule object.</p>
<p>Hydroxy oxygen atoms are defined as oxygen atoms bonded to at least one hydrogen atom (–OH),
and sulfur atoms are defined as sulfur atoms bonded to at least one hydrogen atom (–SH), indicating
the presence of alcohol or thiol groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit molecule object to be analyzed. This molecule will be checked for hydroxy oxygen and sulfur atoms.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hydroxy_atoms</strong> – A list of indices for oxygen and sulfur atoms bonded to at least one hydrogen atom,
indicating the presence of hydroxy or thiol groups respectively.
Atom indices are zero-based, matching the order in which atoms appear in the RDKit molecule object.
If no hydroxy or thiol atoms are found, the list will be empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(C)O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_hydroxy_oxygen</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[4]  # The oxygen atom in the hydroxy group is at index 4.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function explicitly adds hydrogen atoms to the molecule for more accurate analysis of hydroxy and thiol groups.</p></li>
<li><p>Only oxygen and sulfur atoms that are bonded to at least one hydrogen atom are included in the result list.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_ketone_alpha_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_ketone_alpha_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_ketone_alpha_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies alpha carbon atoms adjacent to carbonyl carbons in ketones within a given molecule.</p>
<p>Alpha carbon atoms are defined as those that are adjacent to the carbonyl group (C=O) in ketones.
These are typically the carbons bonded to the carbonyl carbon but not directly bonded to the oxygen atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit molecule object representing the molecule to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ketone_alpha_carbons</strong> – A list of indices for alpha carbon atoms that are adjacent to carbonyl carbons in ketones.
The atom indices are zero-based, corresponding to the order in which atoms appear in the RDKit molecule object.
If no alpha carbons are found, the list will be empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CC(=O)C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_ketone_alpha_carbons</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[1]  # The alpha carbon adjacent to the carbonyl group at index 1.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function identifies ketones by finding oxygen atoms bonded to a carbonyl carbon.</p></li>
<li><p>It assumes that the carbonyl group has a double bond between the oxygen and carbon.</p></li>
<li><p>The alpha carbon is defined as a carbon atom bonded to the carbonyl carbon but not to the oxygen atom.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_matching_indices">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_matching_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.find_matching_indices" title="Permalink to this definition"></a></dt>
<dd><p>Finds indices in ‘sorted_choices’ that match the criteria specified in ‘selection’,
considering constraints on repetition and randomly selecting from matching indices
while adhering to the repetition limits.</p>
<p>This function takes a nested dictionary ‘selection’ that specifies how many times each
combination of ‘C_N_ar’ and ‘O_S’ should be selected, then finds the corresponding
indices from ‘sorted_choices’ that meet these criteria while enforcing limits on the
number of times each index can be chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>dict</em>) – A nested dictionary where the first level keys represent ‘C_N_ar’ values, and the second
level keys represent ‘O_S’ values. The values are integers indicating how many times that
specific combination of ‘C_N_ar’ and ‘O_S’ should be selected.</p></li>
<li><p><strong>sorted_choices</strong> (<em>list</em><em> of </em><em>dicts</em>) – A list where each dictionary represents a possible choice. Each dictionary contains keys such
as ‘C_N_ar’ and ‘O_S’ among others. These are the possible combinations from which the function
selects the matching indices according to the specified criteria in ‘selection’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>indices</strong> – A list of indices from ‘sorted_choices’ that match the ‘selection’ criteria. Each index corresponds
to an entry in ‘sorted_choices’ that fits one of the combinations specified in ‘selection’.
The indices are chosen while respecting the maximum repetition allowed for each index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">selection</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_choices</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_matching_indices</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">sorted_choices</span><span class="p">)</span>
<span class="go">[0, 1, 2]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function ensures that each index is selected within the limit specified by ‘selection’.</p></li>
<li><p>Random selection is used from matching indices, and the selection is done uniformly with respect to
the repetition constraints.</p></li>
<li><p>If there are more requested selections than matching options, the available indices will be selected
multiple times while adhering to the specified repeat limits.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_min_H_selection">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_min_H_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_final_selections</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#coal.utils.find_min_H_selection" title="Permalink to this definition"></a></dt>
<dd><p>Finds the selection from all possible combinations that results in the minimum total hydrogen (H) count.</p>
<p>This function evaluates a list of possible selections (<cite>all_final_selections</cite>) and calculates the total
hydrogen (H) count for each selection. It then returns the selection with the minimum hydrogen count.
The total H count for a selection is computed by iterating through each hydrogen value and its respective
counts in the selection, using the data from <cite>self.nested_dict_H</cite> to calculate the contribution of each
combination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>all_final_selections</strong> (<em>list</em><em> of </em><em>dict</em>) – A list of dictionaries where each dictionary represents a potential selection of combinations.
Each dictionary contains keys representing hydrogen (H) values and their associated oxygen-sulfur (O_S) values,
with counts indicating how many times a specific combination is chosen.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The selection (a dictionary) from <cite>all_final_selections</cite> that has the minimum total hydrogen count.
If there are multiple selections with the same total hydrogen count, the first one encountered will be returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_final_selections</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_min_H_selection</span><span class="p">(</span><span class="n">all_final_selections</span><span class="p">)</span>
<span class="go">{2: {3: 1, 4: 2}, 4: {5: 1}}</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function calculates the total hydrogen count by iterating through each hydrogen value (H)
and its respective oxygen-sulfur (O_S) combinations, multiplying the counts by the corresponding
values from <cite>self.nested_dict_H</cite>.</p></li>
<li><p>The selection with the smallest total H count is returned. This can be useful for minimizing resource
usage or optimizing a process that relies on hydrogen consumption.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_required_aldehyde_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_required_aldehyde_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_required_aldehyde_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies carbon atoms in a molecule that are part of an aldehyde group.
An aldehyde carbon is defined as a carbon atom having exactly three neighbors:
one carbon (C), one hydrogen (H), and one oxygen (O).</p>
<p>This function processes a SMILES string to identify the aldehyde group carbon atoms
by checking their neighbors and ensures that the carbon atom meets the criteria for being part of an aldehyde group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – A SMILES string representing the molecular structure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices corresponding to carbon atoms that are part of an aldehyde group within the molecule.
Atom indices are zero-based, matching the order in which atoms appear in the RDKit molecule object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_required_aldehyde_carbons</span><span class="p">(</span><span class="s1">&#39;C=O&#39;</span><span class="p">)</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function creates an RDKit molecule object from the provided SMILES string and adds hydrogens explicitly to the molecule for better atom detection.</p></li>
<li><p>The carbon atoms are considered part of an aldehyde if they are bonded to one hydrogen, one carbon, and one oxygen atom.</p></li>
<li><p>This can be useful in synthetic chemistry or molecular analysis where aldehyde functionalities need to be identified.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.find_required_carbons">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">find_required_carbons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.find_required_carbons" title="Permalink to this definition"></a></dt>
<dd><p>Identifies carbon atoms in a molecule that are connected to exactly two other carbon (or nitrogen) atoms and one hydrogen atom.</p>
<p>This function analyzes the given SMILES string and identifies carbon atoms that satisfy the following conditions:
- The carbon atom is connected to exactly two other carbon (or nitrogen) atoms.
- The carbon atom is also connected to exactly one hydrogen atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – A SMILES string representing the molecular structure to be analyzed. This string should be valid and represent a molecule in which
carbon atoms meet the specified connectivity criteria.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices corresponding to carbon atoms that meet the specified connectivity criteria within the molecule.
Atom indices are zero-based, matching the order in which atoms appear in the RDKit molecule object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_required_carbons</span><span class="p">(</span><span class="s1">&#39;CC(N)C&#39;</span><span class="p">)</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses RDKit to parse the SMILES string and then explicitly adds hydrogens to the molecule for proper analysis.</p></li>
<li><p>The function checks each carbon atom in the molecule for connectivity with exactly two other carbons (or nitrogen atoms)
and exactly one hydrogen atom. If these conditions are met, the atom’s index is added to the result list.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.generate_candidate_smiles">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">generate_candidate_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_H_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_choices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_smiles_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_C_al</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.generate_candidate_smiles" title="Permalink to this definition"></a></dt>
<dd><p>Generates a list of candidate SMILES strings based on a selection criteria,
and calculates the predicted chemical formula for these candidates, adjusting
for a target count of aliphatic carbon (C_al).</p>
<p>This function selects candidate SMILES strings from a given list based on the hydrogen
selection criteria provided in <cite>min_H_selection</cite>. After selecting the candidates,
it calculates the total number of aliphatic carbon atoms (C_al) and adjusts the selection
to meet the target number of aliphatic carbons specified by <cite>target_C_al</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_H_selection</strong> (<em>dict</em>) – A nested dictionary specifying the minimum selection criteria for hydrogen counts in
the candidates. The keys represent the hydrogen groupings, and the values indicate
the number of selections for each combination.</p></li>
<li><p><strong>sorted_choices</strong> (<em>list</em><em> of </em><em>dicts</em>) – A list of dictionaries where each dictionary contains properties like ‘C_N_ar’, ‘C_al’,
‘O_S’, and ‘H’ counts corresponding to possible chemical choices.</p></li>
<li><p><strong>sorted_smiles_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list of SMILES strings corresponding to the chemical choices in <cite>sorted_choices</cite>.</p></li>
<li><p><strong>target_C_al</strong> (<em>int</em>) – The target total number of aliphatic carbon atoms (C_al) that the final set of selected
candidates should contain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A list of selected candidate SMILES strings that meet the selection criteria.</p></li>
<li><p>A string representing the predicted chemical formula of the combined candidates,
adjusting for any additional carbon atoms to meet the target C_al count.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">min_H_selection</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_choices</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;C_al&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;C_N_ar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;C_al&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;O_S&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sorted_smiles_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC(C)C&#39;</span><span class="p">,</span> <span class="s1">&#39;CCO&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_C_al</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_candidate_smiles</span><span class="p">(</span><span class="n">min_H_selection</span><span class="p">,</span> <span class="n">sorted_choices</span><span class="p">,</span> <span class="n">sorted_smiles_list</span><span class="p">,</span> <span class="n">target_C_al</span><span class="p">)</span>
<span class="go">([&#39;CC(C)C&#39;, &#39;CCO&#39;, &#39;C&#39;, &#39;C&#39;], &#39;C4H8O2&#39;)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function selects candidates based on hydrogen counts and the corresponding
SMILES strings.</p></li>
<li><p>If the total C_al value from selected candidates is less than the target, extra
carbon atoms are added (represented as ‘C’) to meet the required target.</p></li>
<li><p>The final chemical formula is calculated based on the selected candidates and the
added carbon atoms.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.getPackage">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">getPackage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_smiles_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.getPackage" title="Permalink to this definition"></a></dt>
<dd><p>Sorts a list of SMILES based on their calculated elemental compositions.
The sorting criteria prioritize compounds with higher ratios of certain elements to H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>total_smiles_list</strong> (<em>list</em>) – A list of SMILES.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of SMILES strings sorted according to their elemental composition ratios.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.getTarget">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">getTarget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C90</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ele_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_moles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carbonyl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydroxyl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.getTarget" title="Permalink to this definition"></a></dt>
<dd><p>Adjusts the target atom counts for a chemical compound based on specified carbon moles,
elemental mass ratios, and the percentages of carboxyl and hydroxyl groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C90</strong> (<em>float</em>) – The degree of aromaticity.</p></li>
<li><p><strong>ele_ratio</strong> (<em>dict</em>) – Elemental mass percentages (e.g., {‘C’: 80, ‘H’: 10, ‘O’: 10}).</p></li>
<li><p><strong>C_moles</strong> (<em>float</em>) – The number of carbon atoms.</p></li>
<li><p><strong>carbonyl</strong> (<em>int</em>) – The number of carbonyl groups.</p></li>
<li><p><strong>hydroxyl</strong> (<em>int</em>) – The number of hydroxyl groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated chemical formula and the adjusted target atom counts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[dict, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.merge_count_atoms">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">merge_count_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#coal.utils.merge_count_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the target property of each element of a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – SMILES of a molecule.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of atom counts (e.g., {‘C_N_ar’: 15, ‘C_al’: 0, ‘O_S’: 1, ‘H’: 7}).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.parallel_backtrack_combinations">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">parallel_backtrack_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nested_dict_H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection_dic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_O_S</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.parallel_backtrack_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Parallelized version of backtracking to find combinations of hydrogen (H) and oxygen-sulfur (O_S) values
that match a specified target O_S sum, using multiple cores for faster computation. This function explores all
possible combinations of H and O_S values and finds those that meet the target O_S sum while adhering to the
required hydrogen counts specified in <cite>selection_dic</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nested_dict_H</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – A nested dictionary where the first level keys represent hydrogen counts (H) and the second level keys
represent oxygen-sulfur (O_S) values. The values in the dictionary represent the number of times each H-O_S
combination can be used.</p></li>
<li><p><strong>selection_dic</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – A dictionary where the keys represent hydrogen counts (H) and the values represent the total number of times
each hydrogen count must be used in the solution.</p></li>
<li><p><strong>target_O_S</strong> (<em>int</em>) – The target sum of oxygen-sulfur (O_S) values that the selected combinations of H and O_S should match.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum depth to which the backtracking algorithm will explore. Default is 50. This parameter is used to control
the recursion depth in the backtracking algorithm, helping to avoid excessive computation for larger inputs.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of parallel jobs (cores) to use for processing the subtasks. Default is 40. This controls how many parallel
processes the algorithm will use to speed up the backtracking computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, where each dictionary represents a valid combination of hydrogen (H) and oxygen-sulfur (O_S)
values that satisfy the target O_S sum and the required hydrogen counts as specified in <cite>selection_dic</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[int, Dict[int, int]]]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nested_dict_H</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mi">12</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selection_dic</span> <span class="o">=</span> <span class="p">{</span><span class="mi">12</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_O_S</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parallel_backtrack_combinations</span><span class="p">(</span><span class="n">nested_dict_H</span><span class="p">,</span> <span class="n">selection_dic</span><span class="p">,</span> <span class="n">target_O_S</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[{&#39;12&#39;: {2: 1, 3: 1}, &#39;8&#39;: {2: 1}}]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function divides the work into subtasks for parallelization by distributing the combinations to multiple cores.</p></li>
<li><p>It uses the <cite>joblib</cite> library for parallel execution, allowing efficient use of multiple CPU cores.</p></li>
<li><p>If a solution exceeds the <cite>max_depth</cite>, the function will stop further exploration for that branch.</p></li>
<li><p>The function returns all valid combinations that meet the target O_S sum and hydrogen count criteria.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.process_smiles">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">process_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.process_smiles" title="Permalink to this definition"></a></dt>
<dd><p>Sorts a list of SMILES strings in a zigzag pattern based on the sum of atomic numbers in each molecule.</p>
<p>This function sorts a list of SMILES strings by the sum of the atomic numbers of the atoms in the molecule.
The sorted list is then arranged in a zigzag pattern: the highest sum atomic number is placed at the first
position, the second highest at the second position, and so on, alternating between the highest and lowest
sums.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list containing SMILES strings of the molecules to analyze. The molecules will be sorted
based on the sum of atomic numbers of their constituent atoms.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of SMILES strings sorted in a zigzag pattern based on the sum of atomic numbers
in each molecule. The list is arranged such that the highest sums are placed at even indices and
the lowest sums at odd indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smiles_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CCO&#39;</span><span class="p">,</span> <span class="s1">&#39;CC(C)C&#39;</span><span class="p">,</span> <span class="s1">&#39;CCCC&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">process_smiles</span><span class="p">(</span><span class="n">smiles_list</span><span class="p">)</span>
<span class="go">[&#39;CC(C)C&#39;, &#39;CCCC&#39;, &#39;CCO&#39;]  # Example output showing zigzag sorted order</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The sum of atomic numbers is calculated for each molecule by summing the atomic numbers of all atoms
in the molecule.</p></li>
<li><p>The zigzag pattern alternates between the highest and lowest sums, placing the highest sums in even positions
(0-based index) and the lowest sums in odd positions.</p></li>
<li><p>The sorting ensures that the list is not simply sorted by atomic number sums in ascending or descending order,
but rather in a unique “zigzag” pattern.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.read_json">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">read_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#coal.utils.read_json" title="Permalink to this definition"></a></dt>
<dd><p>Reads a JSON file and returns its content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>str</em>) – Path to the JSON file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The content of the JSON file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.recommended_carbonyl_hydroxyl">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">recommended_carbonyl_hydroxyl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_moles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ele_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#coal.utils.recommended_carbonyl_hydroxyl" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the number of carbonyl and hydroxyl groups based on atom counts and compound type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_moles</strong> (<em>float</em>) – Number of carbon atoms in the compound.</p></li>
<li><p><strong>ele_ratio</strong> (<em>dict</em>) – Elemental percentage (e.g., {‘C’: 80, ‘H’: 10, ‘O’: 10}).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of carbonyl and hydroxyl groups in the compound.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.repeat_connect_rings_C4">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">repeat_connect_rings_C4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repeats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#coal.utils.repeat_connect_rings_C4" title="Permalink to this definition"></a></dt>
<dd><p>Iteratively connects a butane molecule to the given molecule a specified number of times.</p>
<p>This function uses the <cite>connect_rings_C4</cite> function to iteratively connect a butane molecule
to the provided molecule. The connection is repeated for the given number of times, or until
no suitable carbon atoms for connection are found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – A SMILES string representing the initial molecule to be modified. The function will attempt
to connect butane molecules to it in the specified number of iterations.</p></li>
<li><p><strong>num_repeats</strong> (<em>int</em>) – The number of times the butane molecule should be connected to the initial molecule.
Each iteration will attempt to connect another butane molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The SMILES string representing the modified molecule after all connections have been made.
If at any point the connection cannot be made (e.g., no suitable carbons are found), the function
returns the most recent successful modification or the original molecule if no modifications were made.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">repeat_connect_rings_C4</span><span class="p">(</span><span class="s2">&quot;CC(C)C&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;CC(C)CCCCCCCCCCCC&#39;  # Example output after 3 iterations of connecting butane.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function makes use of <cite>connect_rings_C4</cite> to handle the actual connection of butane molecules.</p></li>
<li><p>If no suitable carbon atoms for bonding are found in any iteration, the function terminates early.</p></li>
<li><p>The molecule is modified by repeatedly connecting butane molecules, and the result is returned as a SMILES string.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.select_carbons_from_different_rings">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">select_carbons_from_different_rings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_molecule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ring_carbons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.select_carbons_from_different_rings" title="Permalink to this definition"></a></dt>
<dd><p>Select up to <cite>n</cite> carbon atoms from different rings within the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_molecule</strong> (<em>str</em>) – SMILES representation of the molecule.</p></li>
<li><p><strong>ring_carbons</strong> (<em>list</em>) – A list of indices of carbon atoms within rings.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The number of carbon atoms to select, each from a different ring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>selected_indices</strong> – A list of selected carbon atom indices, each from different rings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.show_atom_number">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">show_atom_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mol</span></span></span><a class="headerlink" href="#coal.utils.show_atom_number" title="Permalink to this definition"></a></dt>
<dd><p>Label each atom in the given molecule with its index.</p>
<p>This function modifies the input RDKit molecule by adding a property to each atom
that stores its index. This index can later be accessed using the provided label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – The RDKit molecule object whose atoms are to be labeled. This object is modified in place.</p></li>
<li><p><strong>label</strong> (<em>str</em>) – The label under which the atom index will be stored. This label can then be used to access the atom index from the atom properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mol</strong> – The RDKit molecule object with atoms labeled with their indices. Note that the molecule is modified in place,
so the returned object is the same as the input object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rdkit.Chem.Mol</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCO&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_mol</span> <span class="o">=</span> <span class="n">show_atom_number</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;atom_index&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">labeled_mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetProp</span><span class="p">(</span><span class="s1">&#39;atom_index&#39;</span><span class="p">))</span>
<span class="go">0</span>
<span class="go">1</span>
<span class="go">2</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The atom index is stored as a string property under the specified <cite>label</cite>.</p></li>
<li><p>This function is useful for identifying and tracking individual atoms in a molecule, especially when performing atom-level analysis.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.show_ring_carbon_numbers">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">show_ring_carbon_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#coal.utils.show_ring_carbon_numbers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coal.utils.update_smiles_lists">
<span class="sig-prename descclassname"><span class="pre">coal.utils.</span></span><span class="sig-name descname"><span class="pre">update_smiles_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_list2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#coal.utils.update_smiles_lists" title="Permalink to this definition"></a></dt>
<dd><p>Processes two lists of SMILES strings: connects propane molecules to the first list’s molecules if specific criteria are met,
and then adjusts the second list by removing elements to compensate for the carbons added to the first list.</p>
<p>This function iterates through the first list of SMILES (<cite>smiles_list1</cite>) and connects a propane molecule (‘CCC’)
to the molecules that meet specific criteria (those containing aldehyde carbon atoms). It then calculates the
difference in the number of carbon atoms between the original and modified molecules in the first list.
Based on this difference, it adjusts the second list (<cite>smiles_list2</cite>) by removing the necessary number of elements
to compensate for the added carbons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list1</strong> (<em>list</em><em> of </em><em>str</em>) – The first list of SMILES strings to be potentially modified by connecting propane molecules.
Each molecule in this list is checked for the presence of aldehyde carbon atoms and modified if necessary.</p></li>
<li><p><strong>smiles_list2</strong> (<em>list</em><em> of </em><em>str</em>) – The second list of SMILES strings, from which elements will be removed to compensate for the carbons added to the first list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing two lists:
- The modified first list with propane molecules connected as applicable.
- The adjusted second list with elements removed to compensate for added carbons.</p>
<p>If there are not enough elements in the second list to compensate for the added carbons, returns None.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of lists or None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smiles_list1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC(=O)C&#39;</span><span class="p">,</span> <span class="s1">&#39;CCC&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smiles_list2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update_smiles_lists</span><span class="p">(</span><span class="n">smiles_list1</span><span class="p">,</span> <span class="n">smiles_list2</span><span class="p">)</span>
<span class="go">([&#39;CC(=O)CCC&#39;, &#39;CCC&#39;], [&#39;C&#39;, &#39;C&#39;, &#39;C&#39;, &#39;C&#39;])</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses the <cite>connect_rings_C3</cite> and <cite>find_required_aldehyde_carbons</cite> functions to identify which molecules
in the first list require modification.</p></li>
<li><p>If the second list does not have enough elements to accommodate the added carbons, the function prints an error message
and returns <cite>None</cite>.</p></li>
<li><p>The function assumes that elements in the second list are simple carbon atoms represented by the SMILES string <cite>‘C’</cite>.</p></li>
</ul>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CoalGenerator.html" class="btn btn-neutral float-left" title="CoalGenerator Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="main.html" class="btn btn-neutral float-right" title="main Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Haodong Liu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>